import{reactive as e}from"vue";import t from"axios";function p(e,t={}){const o=new FormData;t.method&&("put"===t.method.toLowerCase()||"patch"===t.method.toLowerCase())&&o.append("_method",t.method.toUpperCase());for(const r in e)if(!t.exclude||!t.exclude.includes(r)){if(r.startsWith("remove_")&&e[r]){o.append(r,1);continue}if(null===e[r]||void 0===e[r]){o.append(r,"");continue}""===e[r]&&t.skipEmpty||o.append(r,e[r])}return o}function l({endpoint:o,emit:r,onClose:n,eventName:s="created",method:a="post"}){const i=e({});return{apiErrors:i,submit:async function(e){try{Object.keys(i).forEach(e=>delete i[e]);const c="put"===a||"patch"===a?p(e,{method:a}):p(e),d=await t.post(o,c);return r(s),n&&n(),d}catch(e){if(422===e.response?.status&&e.response?.data?.errors){const t=e.response.data.errors;for(const e in t)i[e]=Array.isArray(t[e])?t[e][0]:t[e]}throw e}}}}export{l};
