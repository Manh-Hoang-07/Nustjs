import{defineAsyncComponent as t,ref as e,mergeProps as n,unref as s,useSSRContext as a}from"vue";import{ssrRenderAttrs as r,ssrRenderComponent as i,ssrRenderList as o,ssrInterpolate as l,ssrRenderClass as d,ssrIncludeBooleanAttr as c}from"vue/server-renderer";import{s as u,r as p,d as m}from"./SkeletonLoader-CWl9hP-i.mjs";import{m as x}from"./ConfirmModal-CltOniOu.mjs";import{i as h}from"./Actions-B-4SIiXX.mjs";import{c as y}from"./enums-Bz77BRzt.mjs";import{p as g}from"./endpoints-B4pxijLT.mjs";import"./useApiClient-LtAAs9ek.mjs";import"axios";import"./server.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"node:url";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/utils";import"vue-router";import"./_plugin-vue_export-helper-DlAUqK2U.mjs";import"./Modal-CcMmmM3q.mjs";const f={__name:"index",__ssrInlineRender:!0,setup(a){const f=t(()=>import("./create-DF0VXitO.mjs")),w=t(()=>import("./edit-BRx9FdAn.mjs")),_=t(()=>import("./filter-vqUMzYei.mjs")),{items:k,loading:q,pagination:C,filters:A,fetchData:B,updateFilters:T,deleteItem:D}=u(g.permissions.list,{defaultFilters:{search:"",status:"",sort_by:"created_at_desc"}}),{showSuccess:M,showError:S}=m(),X=e(null),z=e(!1),O=e(!1),R=e(!1);function I(t){T(t)}function v(){z.value=!1}function K(t){X.value=t,O.value=!0}function b(){O.value=!1,X.value=null}function Q(t){X.value=t,R.value=!0}function $(){R.value=!1,X.value=null}async function F(){await B(),v(),M("Quyền đã được tạo thành công")}async function L(){await B(),b(),M("Quyền đã được cập nhật thành công")}async function U(){try{await D(X.value.id),$(),M("Quyền đã được xóa thành công")}catch{S("Không thể xóa quyền")}}function j(t){return"active"===t?"bg-green-100 text-green-800":"inactive"===t?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}return(t,e,a,u)=>{e(`<div${r(n({class:"container mx-auto p-4"},u))}><div class="flex justify-between items-center mb-6"><h1 class="text-2xl font-bold">Quản lý quyền</h1><button class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none"> Thêm quyền mới </button></div>`),e(i(s(_),{"initial-filters":s(A),"onUpdate:filters":I},null,a)),e('<div class="bg-white shadow-md rounded-lg overflow-hidden">'),s(q)?e(i(p,{type:"table",rows:5,columns:7},null,a)):(e('<table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tên quyền</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tên hiển thị</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Guard</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quyền cha</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Trạng thái</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Thao tác</th></tr></thead><tbody class="bg-white divide-y divide-gray-200">\x3c!--[--\x3e'),o(s(k),t=>{e(`<tr><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${l(t.id)}</td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${l(t.name)}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${l(t.display_name)}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${l(t.guard_name)}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${l(t.parent_name||"-- Không có --")}</td><td class="px-6 py-4 whitespace-nowrap"><span class="${d([j(t.status),"px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])}">${l(function(t){return y("basic_status",t)||t||"Không xác định"}(t.status))}</span></td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium">`),t.has_children?e("\x3c!----\x3e"):e(i(h,{item:t,onEdit:K,onDelete:Q},null,a)),t.has_children?e(`<span class="text-gray-500 text-sm"> Không thể sửa/xóa (có ${l(t.children_count)} quyền con) </span>`):e("\x3c!----\x3e"),e("</td></tr>")}),e("\x3c!--]--\x3e"),0===s(k).length?e('<tr><td colspan="7" class="px-6 py-4 text-center text-gray-500"> Không có dữ liệu </td></tr>'):e("\x3c!----\x3e"),e("</tbody></table>")),e(`</div><div class="mt-4 flex justify-between items-center"><div class="text-sm text-gray-700"> Hiển thị ${l(s(C).from)} đến ${l(s(C).to)} trên tổng số ${l(s(C).total)} bản ghi </div><div class="flex space-x-1">\x3c!--[--\x3e`),o(s(C).links,t=>{e(`<button${c(!t.url)?" disabled":""} class="${d(["px-3 py-1 border rounded",t.active?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50",!t.url&&"opacity-50 cursor-not-allowed"])}">${t.label??""}</button>`)}),e("\x3c!--]--\x3e</div></div>"),z.value?e(i(s(f),{show:z.value,"on-close":v,onCreated:F},null,a)):e("\x3c!----\x3e"),O.value?e(i(s(w),{show:O.value,permission:X.value,"on-close":b,onUpdated:L},null,a)):e("\x3c!----\x3e"),R.value?e(i(x,{show:R.value,title:"Xác nhận xóa",message:"Bạn có chắc chắn muốn xóa quyền này không?",onConfirm:U,onCancel:$},null,a)):e("\x3c!----\x3e"),e("</div>")}}},w=f.setup;f.setup=(t,e)=>{const n=a();return(n.modules||(n.modules=new Set)).add("pages/admin/permissions/index.vue"),w?w(t,e):void 0};export{f as default};
