import{ssrRenderAttrs as e,ssrRenderComponent as t}from"vue/server-renderer";import o from"./form-DR-rgvXH.mjs";import{p as r}from"./endpoints-B4pxijLT.mjs";import{ref as s,reactive as i,watch as p,useSSRContext as m}from"vue";import{o as n}from"./enums-Bz77BRzt.mjs";import{E as u}from"./useApiClient-LtAAs9ek.mjs";import"./Modal-CcMmmM3q.mjs";import"./_plugin-vue_export-helper-DlAUqK2U.mjs";import"./FormWrapper-BkWXOK5b.mjs";import"./FormField-C25kxm9c.mjs";import"./debounce-CONOwAJH.mjs";import"./apiClient-CZcLLw7q.mjs";import"axios";import"./ImageUploader-CkuS8dvw.mjs";import"./server.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"node:url";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/utils";import"vue-router";const a={__name:"edit",__ssrInlineRender:!0,props:{show:Boolean,product:Object,onClose:Function},emits:["updated"],setup(m,{emit:a}){const d=u(),l=m,c=a,v=s(!1),f=i({}),j=s({}),h=s(null),y=s(!1);function C(){const e=n("product_status");j.value=e.map(e=>({value:e.value,label:e.label}))}async function _(e){try{if(!l.product)return;Object.keys(f).forEach(e=>delete f[e]);const t={...e,_method:"PUT"};await d.post(r.products.update(l.product.id),t),c("updated"),l.onClose()}catch(e){if(422===e.response?.status&&e.response?.data?.errors){const t=e.response.data.errors;for(const e in t)Array.isArray(t[e])?f[e]=t[e][0]:f[e]=t[e]}}}function b(){l.onClose&&l.onClose()}return p(()=>l.show,e=>{v.value=e,e?(Object.keys(f).forEach(e=>delete f[e]),C(),l.product?.id&&async function(){if(l.product?.id){y.value=!0;try{const e=await d.get(`/api/admin/products/${l.product.id}`);h.value=e.data.data||e.data}catch{h.value=l.product}finally{y.value=!1}}}()):h.value=null},{immediate:!0}),(r,s,i,p)=>{s(`<div${e(p)}>`),v.value?s(t(o,{show:v.value,product:h.value,"api-errors":f,"status-options":j.value,loading:y.value,mode:"edit",onSubmit:_,onCancel:b},null,i)):s("\x3c!----\x3e"),s("</div>")}}},d=a.setup;a.setup=(e,t)=>{const o=m();return(o.modules||(o.modules=new Set)).add("pages/admin/products/edit.vue"),d?d(e,t):void 0};export{a as default};
