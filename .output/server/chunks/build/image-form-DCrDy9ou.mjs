import{computed as e,reactive as t,ref as r,watch as o,mergeProps as l,withCtx as d,createVNode as a,withModifiers as s,createBlock as n,createCommentVNode as i,withDirectives as u,createTextVNode as m,vModelText as p,openBlock as c,toDisplayString as x,useSSRContext as b}from"vue";import{ssrRenderComponent as g,ssrRenderAttr as f,ssrRenderClass as h,ssrInterpolate as y,ssrIncludeBooleanAttr as v}from"vue/server-renderer";import{R as $}from"./Modal-CcMmmM3q.mjs";import"./_plugin-vue_export-helper-DlAUqK2U.mjs";const w={__name:"image-form",__ssrInlineRender:!0,props:{show:Boolean,image:Object,productId:[String,Number],apiErrors:{type:Object,default:()=>({})},mode:String},emits:["submit","cancel","created","updated"],setup(b,{emit:w}){const _=b,E=w,U=e({get:()=>_.show,set:()=>C()}),j=e(()=>"edit"===_.mode?"Chỉnh sửa ảnh":"Thêm ảnh mới"),V=t({url:"",alt_text:"",caption:"",order:0}),M=t({}),R=r(!1);function k(){Object.keys(M).forEach(e=>delete M[e])}function D(){if(k(),V.url.trim()?V.url.length>500&&(M.url="URL ảnh không được vượt quá 500 ký tự"):M.url="URL ảnh là bắt buộc",V.alt_text&&V.alt_text.length>255&&(M.alt_text="Mô tả ảnh không được vượt quá 255 ký tự"),V.caption&&V.caption.length>500&&(M.caption="Chú thích không được vượt quá 500 ký tự"),V.order<0&&(M.order="Thứ tự không được âm"),0===Object.keys(M).length){R.value=!0;try{const e=new FormData;Object.entries(V).forEach(([t,r])=>{null!=r&&""!==r&&e.append(t,r)}),e.append("imageable_type","App\\Models\\Product"),e.append("imageable_id",_.productId),E("submit",e)}finally{R.value=!1}}}function O(e){e.target.style.display="none",e.target.nextElementSibling&&(e.target.nextElementSibling.style.display="block")}function C(){E("cancel")}return o(()=>_.image,e=>{e?(V.url=e.url||"",V.alt_text=e.alt_text||"",V.caption=e.caption||"",V.order=e.order||0):(V.url="",V.alt_text="",V.caption="",V.order=0,k())},{immediate:!0}),(e,t,r,o)=>{t(g($,l({modelValue:U.value,"onUpdate:modelValue":e=>U.value=e,title:j.value},o),{default:d((e,t,r,o)=>{if(!t)return[a("form",{onSubmit:s(D,["prevent"]),class:"space-y-4"},[a("div",null,[a("label",{class:"block text-sm font-medium mb-1"},[m("URL ảnh "),a("span",{class:"text-red-500"},"*")]),u(a("input",{"onUpdate:modelValue":e=>V.url=e,type:"text",class:["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":M.url||b.apiErrors.url}],maxlength:"500"},null,10,["onUpdate:modelValue"]),[[p,V.url]]),M.url?(c(),n("p",{key:0,class:"mt-1 text-sm text-red-600"},x(M.url),1)):b.apiErrors.url?(c(),n("p",{key:1,class:"mt-1 text-sm text-red-600"},x(b.apiErrors.url),1)):i("",!0)]),V.url?(c(),n("div",{key:0,class:"border rounded-lg p-4"},[a("label",{class:"block text-sm font-medium mb-2"},"Xem trước:"),a("img",{src:V.url,alt:V.alt_text||"Preview",class:"w-full h-32 object-cover rounded",onError:O},null,40,["src","alt"])])):i("",!0),a("div",null,[a("label",{class:"block text-sm font-medium mb-1"},"Mô tả ảnh (Alt text)"),u(a("input",{"onUpdate:modelValue":e=>V.alt_text=e,type:"text",class:["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":M.alt_text||b.apiErrors.alt_text}],maxlength:"255"},null,10,["onUpdate:modelValue"]),[[p,V.alt_text]]),M.alt_text?(c(),n("p",{key:0,class:"mt-1 text-sm text-red-600"},x(M.alt_text),1)):b.apiErrors.alt_text?(c(),n("p",{key:1,class:"mt-1 text-sm text-red-600"},x(b.apiErrors.alt_text),1)):i("",!0)]),a("div",null,[a("label",{class:"block text-sm font-medium mb-1"},"Chú thích"),u(a("textarea",{"onUpdate:modelValue":e=>V.caption=e,class:["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":M.caption||b.apiErrors.caption}],rows:"3",maxlength:"500"},null,10,["onUpdate:modelValue"]),[[p,V.caption]]),M.caption?(c(),n("p",{key:0,class:"mt-1 text-sm text-red-600"},x(M.caption),1)):b.apiErrors.caption?(c(),n("p",{key:1,class:"mt-1 text-sm text-red-600"},x(b.apiErrors.caption),1)):i("",!0)]),a("div",null,[a("label",{class:"block text-sm font-medium mb-1"},"Thứ tự hiển thị"),u(a("input",{"onUpdate:modelValue":e=>V.order=e,type:"number",class:["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":M.order||b.apiErrors.order}],min:"0"},null,10,["onUpdate:modelValue"]),[[p,V.order]]),M.order?(c(),n("p",{key:0,class:"mt-1 text-sm text-red-600"},x(M.order),1)):b.apiErrors.order?(c(),n("p",{key:1,class:"mt-1 text-sm text-red-600"},x(b.apiErrors.order),1)):i("",!0)]),a("div",{class:"flex justify-end space-x-3 pt-4"},[a("button",{type:"button",onClick:C,class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none"},"Huỷ"),a("button",{type:"submit",class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none",disabled:R.value},x(R.value?"Đang xử lý...":"edit"===b.mode?"Cập nhật":"Thêm mới"),9,["disabled"])])],32)];t(`<form class="space-y-4"${o}><div${o}><label class="block text-sm font-medium mb-1"${o}>URL ảnh <span class="text-red-500"${o}>*</span></label><input${f("value",V.url)} type="text" class="${h([{"border-red-500":M.url||b.apiErrors.url},"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"])}" maxlength="500"${o}>`),M.url?t(`<p class="mt-1 text-sm text-red-600"${o}>${y(M.url)}</p>`):b.apiErrors.url?t(`<p class="mt-1 text-sm text-red-600"${o}>${y(b.apiErrors.url)}</p>`):t("\x3c!----\x3e"),t("</div>"),V.url?t(`<div class="border rounded-lg p-4"${o}><label class="block text-sm font-medium mb-2"${o}>Xem trước:</label><img${f("src",V.url)}${f("alt",V.alt_text||"Preview")} class="w-full h-32 object-cover rounded"${o}></div>`):t("\x3c!----\x3e"),t(`<div${o}><label class="block text-sm font-medium mb-1"${o}>Mô tả ảnh (Alt text)</label><input${f("value",V.alt_text)} type="text" class="${h([{"border-red-500":M.alt_text||b.apiErrors.alt_text},"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"])}" maxlength="255"${o}>`),M.alt_text?t(`<p class="mt-1 text-sm text-red-600"${o}>${y(M.alt_text)}</p>`):b.apiErrors.alt_text?t(`<p class="mt-1 text-sm text-red-600"${o}>${y(b.apiErrors.alt_text)}</p>`):t("\x3c!----\x3e"),t(`</div><div${o}><label class="block text-sm font-medium mb-1"${o}>Chú thích</label><textarea class="${h([{"border-red-500":M.caption||b.apiErrors.caption},"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"])}" rows="3" maxlength="500"${o}>${y(V.caption)}</textarea>`),M.caption?t(`<p class="mt-1 text-sm text-red-600"${o}>${y(M.caption)}</p>`):b.apiErrors.caption?t(`<p class="mt-1 text-sm text-red-600"${o}>${y(b.apiErrors.caption)}</p>`):t("\x3c!----\x3e"),t(`</div><div${o}><label class="block text-sm font-medium mb-1"${o}>Thứ tự hiển thị</label><input${f("value",V.order)} type="number" class="${h([{"border-red-500":M.order||b.apiErrors.order},"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"])}" min="0"${o}>`),M.order?t(`<p class="mt-1 text-sm text-red-600"${o}>${y(M.order)}</p>`):b.apiErrors.order?t(`<p class="mt-1 text-sm text-red-600"${o}>${y(b.apiErrors.order)}</p>`):t("\x3c!----\x3e"),t(`</div><div class="flex justify-end space-x-3 pt-4"${o}><button type="button" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none"${o}>Huỷ</button><button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none"${v(R.value)?" disabled":""}${o}>${y(R.value?"Đang xử lý...":"edit"===b.mode?"Cập nhật":"Thêm mới")}</button></div></form>`)}),_:1},r))}}},_=w.setup;w.setup=(e,t)=>{const r=b();return(r.modules||(r.modules=new Set)).add("pages/admin/Products/image-form.vue"),_?_(e,t):void 0};export{w as default};
