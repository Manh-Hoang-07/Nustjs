import{ref as e,reactive as t,computed as a,mergeProps as n,withCtx as s,createVNode as o,withModifiers as r,withDirectives as l,createBlock as d,createCommentVNode as i,createTextVNode as u,vModelText as p,openBlock as c,toDisplayString as m,useSSRContext as x}from"vue";import{ssrRenderAttrs as b,ssrRenderList as g,ssrInterpolate as y,ssrRenderClass as v,ssrRenderComponent as f,ssrRenderAttr as h}from"vue/server-renderer";import{s as w}from"./apiClient-CZcLLw7q.mjs";import{p as $}from"./endpoints-B4pxijLT.mjs";import{R as k}from"./Modal-CcMmmM3q.mjs";import"axios";import"./_plugin-vue_export-helper-DlAUqK2U.mjs";const _={__name:"index",__ssrInlineRender:!0,setup(x){const _=e(!1),T=e(""),z=e(""),U=e(""),V=e(""),C=e(""),Z=e(!1),B=e(""),D=e([]),S=e(!1),X=e(""),H=t({}),K=a(()=>({name:[{required:"Tên zone là bắt buộc."},{max:[100,"Tên zone không được vượt quá 100 ký tự."]}],provinces:[{required:"Danh sách tỉnh là bắt buộc."}],base_fee:[{required:"Base fee là bắt buộc."},{number:"Base fee phải là số."}],delivery_time:[{required:"Thời gian giao hàng là bắt buộc."}]}));function q(){Object.keys(H).forEach(e=>delete H[e])}function O(e){return"active"===e||1===e?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}async function j(){S.value=!0,X.value="";try{const e=await w.get($.shippingZones.list);D.value=e.data.data}catch{X.value="Không lấy được danh sách zone!"}finally{S.value=!1}}function M(){_.value=!1,T.value="",q()}async function Q(){if(!function(){q();let e=!0;const t=K.value,a={name:z.value,provinces:U.value,base_fee:V.value,delivery_time:C.value};for(const n in t)for(const s of t[n]){if(s.required&&!a[n]){H[n]=s.required,e=!1;break}if(s.max&&a[n]&&a[n].length>s.max[0]){H[n]=s.max[1],e=!1;break}if(s.number&&a[n]&&isNaN(Number(a[n]))){H[n]=s.number,e=!1;break}}return e}())return;const e=D.value.find(e=>e.name===z.value),t={name:z.value,provinces:U.value,base_fee:V.value,delivery_time:C.value,status:"active"};try{e?await w.put($.shippingZones.update(e.id),t):await w.post($.shippingZones.create,t),await j(),M()}catch{X.value="Lưu zone thất bại!"}}async function G(){const e=D.value.find(e=>e.name===B.value);if(e)try{await w.delete($.shippingZones.delete(e.id)),await j(),Z.value=!1}catch{X.value="Xóa zone thất bại!"}}return(e,t,a,x)=>{t(`<div${b(n({class:"container mx-auto p-4"},x))}><div class="flex justify-between items-center mb-6"><h1 class="text-2xl font-bold">Quản lý Zone Mapping</h1><button class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none"> Thêm Zone mới </button></div><div class="bg-white shadow-md rounded-lg overflow-hidden"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tên Zone</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Số tỉnh</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Base Fee</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Delivery Time</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Trạng thái</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Thao tác</th></tr></thead><tbody class="bg-white divide-y divide-gray-200">\x3c!--[--\x3e`),g(D.value,a=>{t(`<tr><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${y(a.id)}</td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${y(a.name)}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${y(Array.isArray(a.provinces)?a.provinces.length:(a.provinces||"").split(",").length)}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${y(a.base_fee|e.currency)}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${y(a.delivery_time)}</td><td class="px-6 py-4 whitespace-nowrap"><span class="${v([O(a.status),"px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])}">${y(function(e){return"active"===e||1===e?"Đang hoạt động":"inactive"===e||0===e?"Không hoạt động":e}(a.status))}</span></td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium"><button class="text-indigo-600 hover:text-indigo-900 mr-3"> Sửa </button><button class="text-red-600 hover:text-red-900"> Xóa </button></td></tr>`)}),t("\x3c!--]--\x3e"),0===D.value.length?t('<tr><td colspan="7" class="px-6 py-4 text-center text-gray-500"> Không có dữ liệu </td></tr>'):t("\x3c!----\x3e"),t("</tbody></table></div>"),_.value?t(f(k,{modelValue:_.value,"onUpdate:modelValue":e=>_.value=e,title:T.value?"Sửa zone":"Thêm zone mới"},{default:s((e,t,a,n)=>{if(!t)return[o("form",{onSubmit:r(Q,["prevent"]),class:"space-y-4"},[o("div",null,[o("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[u("Tên zone "),o("span",{class:"text-red-500"},"*")]),l(o("input",{"onUpdate:modelValue":e=>z.value=e,type:"text",class:["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":H.name}],maxlength:"100"},null,10,["onUpdate:modelValue"]),[[p,z.value]]),H.name?(c(),d("p",{key:0,class:"mt-1 text-sm text-red-600"},m(H.name),1)):i("",!0)]),o("div",null,[o("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[u("Provinces (phân cách bằng dấu phẩy) "),o("span",{class:"text-red-500"},"*")]),l(o("input",{"onUpdate:modelValue":e=>U.value=e,type:"text",class:["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":H.provinces}]},null,10,["onUpdate:modelValue"]),[[p,U.value]]),H.provinces?(c(),d("p",{key:0,class:"mt-1 text-sm text-red-600"},m(H.provinces),1)):i("",!0)]),o("div",null,[o("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[u("Base Fee "),o("span",{class:"text-red-500"},"*")]),l(o("input",{"onUpdate:modelValue":e=>V.value=e,type:"number",class:["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":H.base_fee}]},null,10,["onUpdate:modelValue"]),[[p,V.value]]),H.base_fee?(c(),d("p",{key:0,class:"mt-1 text-sm text-red-600"},m(H.base_fee),1)):i("",!0)]),o("div",null,[o("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[u("Delivery Time "),o("span",{class:"text-red-500"},"*")]),l(o("input",{"onUpdate:modelValue":e=>C.value=e,type:"text",class:["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":H.delivery_time}]},null,10,["onUpdate:modelValue"]),[[p,C.value]]),H.delivery_time?(c(),d("p",{key:0,class:"mt-1 text-sm text-red-600"},m(H.delivery_time),1)):i("",!0)]),o("div",{class:"flex justify-end space-x-3 pt-4"},[o("button",{type:"button",onClick:M,class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none"},"Huỷ"),o("button",{type:"submit",class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none"},m(T.value?"Cập nhật":"Thêm mới"),1)])],32)];t(`<form class="space-y-4"${n}><div${n}><label class="block text-sm font-medium text-gray-700 mb-1"${n}>Tên zone <span class="text-red-500"${n}>*</span></label><input${h("value",z.value)} type="text" class="${v([{"border-red-500":H.name},"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"])}" maxlength="100"${n}>`),H.name?t(`<p class="mt-1 text-sm text-red-600"${n}>${y(H.name)}</p>`):t("\x3c!----\x3e"),t(`</div><div${n}><label class="block text-sm font-medium text-gray-700 mb-1"${n}>Provinces (phân cách bằng dấu phẩy) <span class="text-red-500"${n}>*</span></label><input${h("value",U.value)} type="text" class="${v([{"border-red-500":H.provinces},"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"])}"${n}>`),H.provinces?t(`<p class="mt-1 text-sm text-red-600"${n}>${y(H.provinces)}</p>`):t("\x3c!----\x3e"),t(`</div><div${n}><label class="block text-sm font-medium text-gray-700 mb-1"${n}>Base Fee <span class="text-red-500"${n}>*</span></label><input${h("value",V.value)} type="number" class="${v([{"border-red-500":H.base_fee},"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"])}"${n}>`),H.base_fee?t(`<p class="mt-1 text-sm text-red-600"${n}>${y(H.base_fee)}</p>`):t("\x3c!----\x3e"),t(`</div><div${n}><label class="block text-sm font-medium text-gray-700 mb-1"${n}>Delivery Time <span class="text-red-500"${n}>*</span></label><input${h("value",C.value)} type="text" class="${v([{"border-red-500":H.delivery_time},"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"])}"${n}>`),H.delivery_time?t(`<p class="mt-1 text-sm text-red-600"${n}>${y(H.delivery_time)}</p>`):t("\x3c!----\x3e"),t(`</div><div class="flex justify-end space-x-3 pt-4"${n}><button type="button" class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none"${n}>Huỷ</button><button type="submit" class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none"${n}>${y(T.value?"Cập nhật":"Thêm mới")}</button></div></form>`)}),_:1},a)):t("\x3c!----\x3e"),Z.value?t(f(k,{modelValue:Z.value,"onUpdate:modelValue":e=>Z.value=e,title:"Xóa zone"},{default:s((e,t,a,n)=>{if(!t)return[o("div",{class:"py-4 text-center"},[o("p",null,[u("Bạn muốn xóa zone "),o("b",null,m(B.value),1),u("?")]),o("div",{class:"flex justify-end gap-2 mt-6"},[o("button",{type:"button",class:"px-4 py-2 bg-gray-200 rounded-lg",onClick:e=>Z.value=!1},"Hủy",8,["onClick"]),o("button",{type:"button",class:"px-4 py-2 bg-red-600 text-white rounded-lg",onClick:G},"Xóa")])])];t(`<div class="py-4 text-center"${n}><p${n}>Bạn muốn xóa zone <b${n}>${y(B.value)}</b>?</p><div class="flex justify-end gap-2 mt-6"${n}><button type="button" class="px-4 py-2 bg-gray-200 rounded-lg"${n}>Hủy</button><button type="button" class="px-4 py-2 bg-red-600 text-white rounded-lg"${n}>Xóa</button></div></div>`)}),_:1},a)):t("\x3c!----\x3e"),t("</div>")}}},T=_.setup;_.setup=(e,t)=>{const a=x();return(a.modules||(a.modules=new Set)).add("pages/admin/Shipping/Zones/index.vue"),T?T(e,t):void 0};export{_ as default};
