import{defineAsyncComponent as t,ref as e,computed as a,mergeProps as r,unref as s,useSSRContext as n}from"vue";import{ssrRenderAttrs as i,ssrRenderComponent as o,ssrRenderList as l,ssrInterpolate as d,ssrRenderClass as u,ssrIncludeBooleanAttr as c}from"vue/server-renderer";import{c as p}from"./enums-Bz77BRzt.mjs";import{s as m,r as x,d as h}from"./SkeletonLoader-CWl9hP-i.mjs";import{m as f}from"./ConfirmModal-CltOniOu.mjs";import{i as v}from"./Actions-B-4SIiXX.mjs";import{p as g}from"./endpoints-B4pxijLT.mjs";import"./useApiClient-LtAAs9ek.mjs";import"axios";import"./server.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"node:url";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/utils";import"vue-router";import"./_plugin-vue_export-helper-DlAUqK2U.mjs";import"./Modal-CcMmmM3q.mjs";const y={__name:"index",__ssrInlineRender:!0,setup(n){const y=t(()=>import("./create-D8fdCRq_.mjs")),w=t(()=>import("./edit-BLPYvS1f.mjs")),_=t(()=>import("./filter-VpqyvXJ7.mjs")),{items:k,loading:C,pagination:T,filters:D,fetchData:S,updateFilters:q,deleteItem:I}=m(g.roles.list,{defaultFilters:{search:"",status:"",sort_by:"created_at_desc"}}),{showSuccess:L,showError:M}=h(),X=e(null),E=e([]),z=e(!1),F=e(!1),O=e(!1);function U(t){q(t)}function b(){z.value=!1}function V(t){X.value=t,F.value=!0}function $(){F.value=!1,X.value=null}function A(t){X.value=t,O.value=!0}function R(){O.value=!1,X.value=null}async function K(){await S(),b(),L("Vai trò đã được tạo thành công")}async function j(){await S(),$(),L("Vai trò đã được cập nhật thành công")}async function B(){try{await I(X.value.id),R(),L("Vai trò đã được xóa thành công")}catch{M("Không thể xóa vai trò")}}function G(t){return"active"===t?"bg-green-100 text-green-800":"inactive"===t?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}const P=a(()=>{const t={};return k.value.forEach(e=>{t[e.id]=e}),t});return(t,e,a,n)=>{e(`<div${i(r({class:"container mx-auto p-4"},n))}><div class="flex justify-between items-center mb-6"><h1 class="text-2xl font-bold">Quản lý vai trò</h1><button class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none"> Thêm vai trò mới </button></div>`),e(o(s(_),{"initial-filters":s(D),"onUpdate:filters":U},null,a)),e('<div class="bg-white shadow-md rounded-lg overflow-hidden">'),s(C)?e(o(x,{type:"table",rows:5,columns:7},null,a)):(e('<table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tên vai trò</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tên hiển thị</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Guard</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Vai trò cha</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Trạng thái</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Thao tác</th></tr></thead><tbody class="bg-white divide-y divide-gray-200">\x3c!--[--\x3e'),l(s(k),t=>{e(`<tr><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${d(t.id)}</td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${d(t.name)}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${d(t.display_name)}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${d(t.guard_name)}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${d(function(t){if(!t)return"—";const e=P.value[t];return e?e.display_name||e.name:t}(t.parent_id))}</td><td class="px-6 py-4 whitespace-nowrap"><span class="${u([G(t.status),"px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])}">${d(function(t){return p("basic_status",t)||t||"Không xác định"}(t.status))}</span></td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium">`),e(o(v,{item:t,onEdit:V,onDelete:A},null,a)),e("</td></tr>")}),e("\x3c!--]--\x3e"),0===s(k).length?e('<tr><td colspan="7" class="px-6 py-4 text-center text-gray-500"> Không có dữ liệu </td></tr>'):e("\x3c!----\x3e"),e("</tbody></table>")),e(`</div><div class="mt-4 flex justify-between items-center"><div class="text-sm text-gray-700"> Hiển thị ${d(s(T).from)} đến ${d(s(T).to)} trên tổng số ${d(s(T).total)} bản ghi </div><div class="flex space-x-1">\x3c!--[--\x3e`),l(s(T).links,t=>{e(`<button${c(!t.url)?" disabled":""} class="${u(["px-3 py-1 border rounded",t.active?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50",!t.url&&"opacity-50 cursor-not-allowed"])}">${t.label??""}</button>`)}),e("\x3c!--]--\x3e</div></div>"),z.value?e(o(s(y),{show:z.value,"status-enums":E.value,"on-close":b,onCreated:K},null,a)):e("\x3c!----\x3e"),F.value?e(o(s(w),{show:F.value,role:X.value,"status-enums":E.value,"on-close":$,onUpdated:j},null,a)):e("\x3c!----\x3e"),O.value?e(o(f,{show:O.value,title:"Xác nhận xóa",message:`Bạn có chắc chắn muốn xóa vai trò ${X.value?.name||""}?`,"on-close":R,onConfirm:B},null,a)):e("\x3c!----\x3e"),e("</div>")}}},w=y.setup;y.setup=(t,e)=>{const a=n();return(a.modules||(a.modules=new Set)).add("pages/admin/roles/index.vue"),w?w(t,e):void 0};export{y as default};
