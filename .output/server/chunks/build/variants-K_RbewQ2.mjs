import{computed as t,ref as e,mergeProps as a,unref as s,useSSRContext as n}from"vue";import{ssrRenderAttrs as r,ssrInterpolate as i,ssrRenderList as l,ssrRenderAttr as p,ssrRenderClass as o,ssrRenderComponent as u}from"vue/server-renderer";import{useRoute as d}from"vue-router";import c from"./variant-form-C5CdkNus.mjs";import{m as x}from"./ConfirmModal-CltOniOu.mjs";import{i as m}from"./Actions-B-4SIiXX.mjs";import{n as y}from"./formatCurrency-CNGtvvPC.mjs";import{E as f}from"./useApiClient-LtAAs9ek.mjs";import"./Modal-CcMmmM3q.mjs";import"./_plugin-vue_export-helper-DlAUqK2U.mjs";import"axios";import"./server.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"node:url";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/utils";const b={__name:"variants",__ssrInlineRender:!0,setup(n){const b=f(),$=d(),k=t(()=>$.params.id),j=e([]),_=e(null),C=e(null),K=e(!1),M=e(!1),N=e(!1),S=e(!1);async function g(){K.value=!0;try{const t=await b.get(`/api/admin/products/${k.value}/variants`);j.value=t.data.data||[]}catch{}finally{K.value=!1}}function w(){M.value=!1}function A(t){C.value=t,N.value=!0}function h(){N.value=!1,C.value=null}function E$1(t){C.value=t,S.value=!0}function v(){S.value=!1,C.value=null}async function I(){await g(),w()}async function K$1(){await g(),h()}async function T(){try{await b.delete(`/api/admin/variants/${C.value.id}`),await g(),v()}catch{}}return(t,e,n,d)=>{e(`<div${r(a({class:"container mx-auto p-4"},d))}><div class="flex justify-between items-center mb-6"><div><h1 class="text-2xl font-bold">Quản lý biến thể sản phẩm</h1><p class="text-gray-600 mt-1">${i(_.value?.name)}</p></div><div class="flex space-x-3"><button class="px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none"> Quay lại sản phẩm </button><button class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none"> Thêm biến thể mới </button></div></div><div class="bg-white shadow-md rounded-lg overflow-hidden"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ảnh</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">SKU</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Barcode</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Giá gốc</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Giá KM</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Số lượng</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Thuộc tính</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Trạng thái</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Thao tác</th></tr></thead><tbody class="bg-white divide-y divide-gray-200">\x3c!--[--\x3e`),l(j.value,t=>{e(`<tr><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${i(t.id)}</td><td class="px-6 py-4 whitespace-nowrap">`),t.image?e(`<img${p("src",t.image)}${p("alt",t.sku)} class="h-10 w-10 rounded-lg object-cover">`):e('<div class="h-10 w-10 rounded-lg bg-gray-200 flex items-center justify-center"><span class="text-gray-400 text-xs">No img</span></div>'),e(`</td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${i(t.sku)}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${i(t.barcode||"N/A")}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${i(s(y)(t.price))}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">`),t.sale_price?e(`<span class="text-red-600 font-medium">${i(s(y)(t.sale_price))}</span>`):e('<span class="text-gray-400">-</span>'),e(`</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${i(t.quantity)}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">`),t.attribute_values&&t.attribute_values.length>0?(e("<div>\x3c!--[--\x3e"),l(t.attribute_values,t=>{e(`<span class="inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1 mb-1">${i(t.attribute?.name)}: ${i(t.value)}</span>`)}),e("\x3c!--]--\x3e</div>")):e('<span class="text-gray-400">Không có</span>'),e(`</td><td class="px-6 py-4 whitespace-nowrap"><span class="${o(["active"===t.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800","px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])}">${i(function(t){return"active"===t?"Đang bán":"inactive"===t?"Ngừng bán":t}(t.status))}</span></td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium">`),e(u(m,{item:t,onEdit:A,onDelete:E$1},null,n)),e("</td></tr>")}),e("\x3c!--]--\x3e"),0===j.value.length?e(`<tr><td colspan="10" class="px-6 py-4 text-center text-gray-500">${i(K.value?"Đang tải dữ liệu...":"Không có biến thể nào")}</td></tr>`):e("\x3c!----\x3e"),e("</tbody></table></div>"),M.value?e(u(c,{show:M.value,"product-id":k.value,"on-close":w,onCreated:I},null,n)):e("\x3c!----\x3e"),N.value?e(u(c,{show:N.value,variant:C.value,"product-id":k.value,"on-close":h,onUpdated:K$1},null,n)):e("\x3c!----\x3e"),S.value?e(u(x,{show:S.value,title:"Xác nhận xóa",message:`Bạn có chắc chắn muốn xóa biến thể ${C.value?.sku||""}?`,"on-close":v,onConfirm:T},null,n)):e("\x3c!----\x3e"),e("</div>")}}},$=b.setup;b.setup=(t,e)=>{const a=n();return(a.modules||(a.modules=new Set)).add("pages/admin/Products/variants.vue"),$?$(t,e):void 0};export{b as default};
