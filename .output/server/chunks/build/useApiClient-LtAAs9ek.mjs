import t from"axios";import{c as e}from"./server.mjs";function E(r={}){const n=e(),{retryAttempts:s=0,retryDelay:i=1e3,timeout:a=3e4,enableRetry:h=!1}=r,o=t.create({baseURL:n.public.apiBase,withCredentials:!0,timeout:a,headers:{"Content-Type":"application/json",Accept:"application/json"}});return o.interceptors.request.use(t=>t,t=>Promise.reject(t)),o.interceptors.response.use(t=>t,t=>Promise.reject(t)),{...o,async get(t,e={}){try{return await o.get(t,e)}catch(e){throw this.handleError(e,"GET",t)}},async post(t,e={},r={}){try{return await o.post(t,e,r)}catch(e){throw this.handleError(e,"POST",t)}},async put(t,e={},r={}){try{return await o.put(t,e,r)}catch(e){throw this.handleError(e,"PUT",t)}},async delete(t,e={}){try{return await o.delete(t,e)}catch(e){throw this.handleError(e,"DELETE",t)}},async patch(t,e={},r={}){try{return await o.patch(t,e,r)}catch(e){throw this.handleError(e,"PATCH",t)}},handleError(t,e,r){return{...t,method:e,url:r,timestamp:(new Date).toISOString(),userMessage:this.getUserFriendlyMessage(t)}},getUserFriendlyMessage(t){const e=t.response?.status,r=t.response?.data;if(r?.message)return r.message;return"ECONNABORTED"===t.code?"Kết nối bị timeout, vui lòng thử lại":"NETWORK_ERROR"===t.code?"Không thể kết nối đến server":{400:"Dữ liệu không hợp lệ",401:"Vui lòng đăng nhập lại",403:"Bạn không có quyền thực hiện hành động này",404:"Không tìm thấy dữ liệu",422:"Dữ liệu không hợp lệ",429:"Quá nhiều yêu cầu, vui lòng thử lại sau",500:"Lỗi server, vui lòng thử lại sau",502:"Lỗi kết nối server",503:"Server đang bảo trì",504:"Hết thời gian chờ kết nối"}[e]||"Có lỗi xảy ra, vui lòng thử lại"}}}export{E};
