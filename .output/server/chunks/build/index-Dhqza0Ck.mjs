import{defineAsyncComponent as t,ref as e,mergeProps as a,unref as s,useSSRContext as n}from"vue";import{ssrRenderAttrs as r,ssrRenderComponent as d,ssrRenderList as o,ssrInterpolate as i,ssrRenderClass as l,ssrIncludeBooleanAttr as c}from"vue/server-renderer";import{s as p,r as u,d as x}from"./SkeletonLoader-CWl9hP-i.mjs";import{m as v}from"./ConfirmModal-CltOniOu.mjs";import{i as m}from"./Actions-B-4SIiXX.mjs";import{p as h}from"./endpoints-B4pxijLT.mjs";import{s as b}from"./_plugin-vue_export-helper-DlAUqK2U.mjs";import"./useApiClient-LtAAs9ek.mjs";import"axios";import"./server.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"node:url";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/utils";import"vue-router";import"./Modal-CcMmmM3q.mjs";const g={__name:"index",__ssrInlineRender:!0,setup(n){const b=t(()=>import("./create-B-hhRGBx.mjs")),g=t(()=>import("./edit-y7wyCtrs.mjs")),y=t(()=>import("./import-Ce5Wbls4.mjs")),f=t(()=>import("./filter-BeRKs4wq.mjs")),{items:w,loading:k,pagination:$,filters:N,fetchData:A,updateFilters:q,deleteItem:I}=p(h.inventory.list,{defaultFilters:{search:"",warehouse_id:"",brand_id:"",category_id:"",stock_status:"",expiry_status:"",sort_by:"updated_at_desc"}}),{showSuccess:K,showError:L}=x(),M=e(null),F=e({brands:[],categories:[],warehouses:[],products:[]}),R=e(!1),E=e(!1),W=e(!1),P=e(!1);function U(t){q(t)}function C(){R.value=!1}function H(t){M.value=t,E.value=!0}function S(){E.value=!1,M.value=null}function D(){W.value=!1}function V(t){M.value=t,P.value=!0}function T(){P.value=!1,M.value=null}async function j(){await A(),C(),K("Tồn kho đã được tạo thành công")}async function B(){await A(),S(),K("Tồn kho đã được cập nhật thành công")}async function G(){await A(),D(),K("Nhập kho thành công")}async function O(){try{await I(M.value.id),T(),K("Tồn kho đã được xóa thành công")}catch{L("Không thể xóa tồn kho")}}function X(t){if(!t)return"bg-gray-100 text-gray-800";const e=new Date,a=new Date(t).getTime()-e.getTime(),s=Math.ceil(a/864e5);return s<0?"bg-red-100 text-red-800":s<=30?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}function _(t){const e=t.quantity||0;return e<=0?"bg-red-100 text-red-800":e<=10?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}return(t,e,n,p)=>{e(`<div${r(a({class:"container mx-auto p-4"},p))} data-v-91b73749><div class="flex justify-between items-center mb-6" data-v-91b73749><h1 class="text-2xl font-bold" data-v-91b73749>Quản lý tồn kho</h1><div class="flex space-x-2" data-v-91b73749><button class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none" data-v-91b73749> Nhập kho </button><button class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none" data-v-91b73749> Thêm tồn kho mới </button></div></div>`),e(d(s(f),{"initial-filters":s(N),warehouses:F.value.warehouses||[],brands:F.value.brands||[],categories:F.value.categories||[],"onUpdate:filters":U},null,n)),e('<div class="bg-white shadow-md rounded-lg overflow-hidden" data-v-91b73749>'),s(k)?e(d(u,{type:"table",rows:5,columns:10},null,n)):(e('<table class="min-w-full divide-y divide-gray-200" data-v-91b73749><thead class="bg-gray-50" data-v-91b73749><tr data-v-91b73749><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-v-91b73749>Sản phẩm</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-v-91b73749>Kho hàng</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-v-91b73749>Lô hàng</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-v-91b73749>Hạn SD</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-v-91b73749>Tổng SL</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-v-91b73749>Đã giữ</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-v-91b73749>Có thể bán</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-v-91b73749>Giá vốn</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-v-91b73749>Trạng thái</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" data-v-91b73749>Thao tác</th></tr></thead><tbody class="bg-white divide-y divide-gray-200" data-v-91b73749>\x3c!--[--\x3e'),o(s(w),t=>{e(`<tr class="hover:bg-gray-50" data-v-91b73749><td class="px-6 py-4 whitespace-nowrap" data-v-91b73749><div data-v-91b73749><div class="text-sm font-medium text-gray-900" data-v-91b73749>${i(t.product_name||"N/A")}</div><div class="text-sm text-gray-500" data-v-91b73749>${i(t.product_code||"N/A")}</div>`),t.variant_sku?e(`<div class="text-xs text-blue-600" data-v-91b73749>${i(t.variant_sku)}</div>`):e("\x3c!----\x3e"),e(`</div></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" data-v-91b73749>${i(t.warehouse_name||"N/A")}</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" data-v-91b73749><div data-v-91b73749>`),t.batch_no?e(`<div class="font-medium" data-v-91b73749>${i(t.batch_no)}</div>`):e("\x3c!----\x3e"),t.lot_no?e(`<div class="text-xs text-gray-500" data-v-91b73749>${i(t.lot_no)}</div>`):e("\x3c!----\x3e"),t.batch_no||t.lot_no?e("\x3c!----\x3e"):e('<div class="text-gray-400" data-v-91b73749>-</div>'),e('</div></td><td class="px-6 py-4 whitespace-nowrap text-sm" data-v-91b73749>'),t.expiry_date?e(`<div data-v-91b73749><span class="${l([X(t.expiry_date),"px-2 py-1 text-xs font-semibold rounded-full"])}" data-v-91b73749>${i(function(t){return t?new Date(t).toLocaleDateString("vi-VN"):"N/A"}(t.expiry_date))}</span></div>`):e('<span class="text-gray-400" data-v-91b73749>Không có hạn</span>'),e(`</td><td class="px-6 py-4 whitespace-nowrap" data-v-91b73749><span class="text-sm font-medium text-gray-900" data-v-91b73749>${i(t.quantity||0)}</span></td><td class="px-6 py-4 whitespace-nowrap" data-v-91b73749><span class="text-sm text-gray-900" data-v-91b73749>${i(t.reserved_quantity||0)}</span></td><td class="px-6 py-4 whitespace-nowrap" data-v-91b73749><span class="text-sm font-medium text-gray-900" data-v-91b73749>${i(t.available_quantity||0)}</span></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" data-v-91b73749>`),t.cost_price?e(`<span data-v-91b73749>${i(function(t){return t?new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t):"0"}(t.cost_price))}</span>`):e('<span class="text-gray-400" data-v-91b73749>-</span>'),e(`</td><td class="px-6 py-4 whitespace-nowrap" data-v-91b73749><span class="${l([_(t),"px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])}" data-v-91b73749>${i(function(t){const e=t.quantity||0;return e<=0?"Hết hàng":e<=10?"Sắp hết":"Còn hàng"}(t))}</span></td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium" data-v-91b73749>`),e(d(m,{item:t,onEdit:H,onDelete:V},null,n)),e("</td></tr>")}),e("\x3c!--]--\x3e"),0===s(w).length?e('<tr data-v-91b73749><td colspan="10" class="px-6 py-4 text-center text-gray-500" data-v-91b73749> Không có dữ liệu </td></tr>'):e("\x3c!----\x3e"),e("</tbody></table>")),e("</div>"),s(w).length>0?(e(`<div class="mt-4 flex justify-between items-center" data-v-91b73749><div class="text-sm text-gray-700" data-v-91b73749> Hiển thị ${i(s($).from||0)} đến ${i(s($).to||0)} trên tổng số ${i(s($).total||0)} bản ghi </div><div class="flex space-x-1" data-v-91b73749>\x3c!--[--\x3e`),o(s($).links,t=>{e(`<button${c(!t.url)?" disabled":""} class="${l(["px-3 py-1 border rounded",t.active?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50",!t.url&&"opacity-50 cursor-not-allowed"])}" data-v-91b73749>${t.label??""}</button>`)}),e("\x3c!--]--\x3e</div></div>")):e("\x3c!----\x3e"),R.value?e(d(s(b),{show:R.value,products:F.value.products||[],warehouses:F.value.warehouses||[],"on-close":C,onCreated:j},null,n)):e("\x3c!----\x3e"),E.value?e(d(s(g),{show:E.value,inventory:M.value,products:F.value.products||[],warehouses:F.value.warehouses||[],"on-close":S,onUpdated:B},null,n)):e("\x3c!----\x3e"),W.value?e(d(s(y),{show:W.value,products:F.value.products||[],warehouses:F.value.warehouses||[],"on-close":D,onImported:G},null,n)):e("\x3c!----\x3e"),P.value?e(d(v,{show:P.value,title:"Xác nhận xóa",message:"Bạn có chắc chắn muốn xóa tồn kho này?","on-close":T,onConfirm:O},null,n)):e("\x3c!----\x3e"),e("</div>")}}},y=g.setup;g.setup=(t,e)=>{const a=n();return(a.modules||(a.modules=new Set)).add("pages/admin/inventory/index.vue"),y?y(t,e):void 0};const f=b(g,[["__scopeId","data-v-91b73749"]]);export{f as default};
