import{ssrRenderAttrs as e,ssrRenderComponent as r}from"vue/server-renderer";import t from"./form-CIyYNOF5.mjs";import{p as s}from"./endpoints-B4pxijLT.mjs";import{ref as o,reactive as i,watch as n,useSSRContext as a}from"vue";import{o as m}from"./enums-Bz77BRzt.mjs";import{E as p}from"./useApiClient-LtAAs9ek.mjs";import"./Modal-CcMmmM3q.mjs";import"./_plugin-vue_export-helper-DlAUqK2U.mjs";import"./FormWrapper-BkWXOK5b.mjs";import"./FormField-C25kxm9c.mjs";import"./useFormDefaults-CTfnk28m.mjs";import"axios";import"./server.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"node:url";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"devalue";import"unhead/utils";import"vue-router";const u={__name:"edit",__ssrInlineRender:!0,props:{show:Boolean,permission:Object,onClose:Function},emits:["updated"],setup(a,{emit:u}){const d=p(),l=a,c=u,v=o(!1),f=o([]),y=o([]),h=o(null),j=o(!1),b=i({});async function w(e){try{if(!l.permission)return;Object.keys(b).forEach(e=>delete b[e]);const r={...e,_method:"PUT"};await d.post(s.permissions.update(l.permission.id),r),c("updated"),l.onClose()}catch(e){if(422===e.response?.status&&e.response?.data?.errors){const r=e.response.data.errors;for(const e in r)Array.isArray(r[e])?b[e]=r[e][0]:b[e]=r[e]}}}function S(){l.onClose&&l.onClose()}return n(()=>l.show,e=>{v.value=e,e?(Object.keys(b).forEach(e=>delete b[e]),async function(){try{const e=m("basic_status");f.value=Array.isArray(e)?e:[]}catch{f.value=[]}}(),async function(){try{const e=(await d.get(s.permissions.list,{params:{per_page:100,relations:"parent"}})).data.data||[];y.value=e.filter(e=>e.id!==l.permission?.id)}catch{y.value=[]}}(),l.permission?.id&&async function(){if(l.permission?.id){j.value=!0;try{const e=await d.get(`/api/admin/permissions/${l.permission.id}`);h.value=e.data.data||e.data}catch{h.value=l.permission}finally{j.value=!1}}}()):(h.value=null,j.value=!1)},{immediate:!0}),(s,o,i,n)=>{o(`<div${e(n)}>`),j.value?o('<div class="flex justify-center items-center p-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div><span class="ml-2 text-gray-600">Đang tải dữ liệu...</span></div>'):v.value?o(r(t,{show:v.value,permission:h.value,"parent-options":y.value,"status-enums":f.value,"api-errors":b,onSubmit:w,onCancel:S},null,i)):o("\x3c!----\x3e"),o("</div>")}}},d=u.setup;u.setup=(e,r)=>{const t=a();return(t.modules||(t.modules=new Set)).add("pages/admin/Permissions/edit.vue"),d?d(e,r):void 0};export{u as default};
