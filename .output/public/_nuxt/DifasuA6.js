import O from"./CK1gEuMu.js";import{e as f}from"./B4pxijLT.js";import{g as A}from"./Bz77BRzt.js";import{M as B,I as n,N as j,O as x,c as h,b as P,e as S,a as v,o as d}from"./CRPNSmKO.js";import"./D3qKhv56.js";import"./DlAUqK2U.js";import"./D_8RvcO3.js";import"./Dlbv5MmI.js";import"./DSJ9rbdv.js";const W={__name:"edit",props:{show:Boolean,permission:Object,onClose:Function},emits:["updated"],setup(y,{emit:b}){const l=B(),s=y,_=b,p=n(!1),u=n([]),m=n([]),i=n(null),c=n(!1),o=j({});x(()=>s.show,e=>{p.value=e,e?(Object.keys(o).forEach(t=>delete o[t]),g(),C(),s.permission?.id&&w()):(i.value=null,c.value=!1)},{immediate:!0});async function w(){if(s.permission?.id){c.value=!0;try{const e=await l.get(`/api/admin/permissions/${s.permission.id}`);i.value=e.data.data||e.data}catch{i.value=s.permission}finally{c.value=!1}}}async function g(){try{const e=A("basic_status");u.value=Array.isArray(e)?e:[]}catch{u.value=[]}}async function C(){try{const t=(await l.get(f.permissions.list,{params:{per_page:100,relations:"parent"}})).data.data||[];m.value=t.filter(a=>a.id!==s.permission?.id)}catch{m.value=[]}}async function k(e){try{if(!s.permission)return;Object.keys(o).forEach(a=>delete o[a]);const t={...e,_method:"PUT"};await l.post(f.permissions.update(s.permission.id),t),_("updated"),s.onClose()}catch(t){if(t.response?.status===422&&t.response?.data?.errors){const a=t.response.data.errors;for(const r in a)Array.isArray(a[r])?o[r]=a[r][0]:o[r]=a[r]}}}function E(){s.onClose&&s.onClose()}return(e,t)=>(d(),h("div",null,[c.value?(d(),h("div",{key:0,class:"flex justify-center items-center p-8"},[v("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),v("span",{class:"ml-2 text-gray-600"},"Đang tải dữ liệu...")])):p.value?(d(),P(O,{key:1,show:p.value,permission:i.value,"parent-options":m.value,"status-enums":u.value,"api-errors":o,onSubmit:k,onCancel:E},null,8,["show","permission","parent-options","status-enums","api-errors"])):S("",!0)]))}};export{W as default};
