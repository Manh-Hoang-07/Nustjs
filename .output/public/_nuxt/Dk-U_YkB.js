import{M as q,G as y,N as E,I as V,z as B,O as D,b as F,i as _,o as i,a as o,w as K,f as m,c as l,e as p,j as T,k as g,K as c,t as u,F as z,g as A,P as G}from"./DDT-0HTi.js";import{g as H}from"./Bz77BRzt.js";import{M as I}from"./D_ZLElLM.js";import"./B4pxijLT.js";import"./DlAUqK2U.js";const W={__name:"form",props:{show:Boolean,order:Object,apiErrors:{type:Object,default:()=>({})},mode:String,loading:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(n,{emit:N}){q();const x=n,h=N,k=y({get:()=>x.show,set:()=>w()}),M=y(()=>x.mode==="edit"?"Chỉnh sửa đơn hàng":"Thêm đơn hàng mới"),e=E({customer_name:"",total_amount:"",status:"",description:"",created_at:"",updated_at:""}),r=E({}),b=V(!1),f=V({});B(O);function O(){const s=H("order_status");f.value=s.map(a=>({value:a.value,label:a.label}))}D(()=>x.order,s=>{s?(e.customer_name=s.customer_name||"",e.total_amount=s.total_amount||"",e.status=s.status||Object.keys(f.value)[0]||"",e.description=s.description||"",e.created_at=s.created_at||"",e.updated_at=s.updated_at||""):j()},{immediate:!0});function j(){e.customer_name="",e.total_amount="",e.status=Object.keys(f.value)[0]||"",e.description="",e.created_at="",e.updated_at="",v()}function v(){Object.keys(r).forEach(s=>delete r[s])}const C=y(()=>({customer_name:[{required:"Khách hàng là bắt buộc"},{max:[100,"Tên khách hàng không được vượt quá 100 ký tự"]}],total_amount:[{required:"Tổng tiền là bắt buộc và phải là số"},{number:"Tổng tiền phải là số"},{min:[0,"Tổng tiền không được âm"]}],description:[{max:[500,"Mô tả không được vượt quá 500 ký tự"]}]}));function S(){v();let s=!0;const a=C.value;for(const t in a)for(const d of a[t]){if(d.required&&!e[t]){r[t]=d.required,s=!1;break}if(d.max&&e[t]&&e[t].length>d.max[0]){r[t]=d.max[1],s=!1;break}if(d.number&&e[t]&&isNaN(Number(e[t]))){r[t]=d.number,s=!1;break}if(d.min&&e[t]&&Number(e[t])<d.min[0]){r[t]=d.min[1],s=!1;break}}return s}function U(){if(S()){b.value=!0;try{const s=new FormData;Object.entries(e).forEach(([a,t])=>{t!=null&&t!==""&&s.append(a,t)}),h("submit",s)}finally{b.value=!1}}}function w(){h("cancel")}return(s,a)=>(i(),F(I,{modelValue:k.value,"onUpdate:modelValue":a[6]||(a[6]=t=>k.value=t),title:M.value,loading:n.loading},{default:_(()=>[o("form",{onSubmit:K(U,["prevent"]),class:"space-y-4"},[o("div",null,[o("label",{class:"block text-sm font-medium mb-1"},[T("Khách hàng "),o("span",{class:"text-red-500"},"*")]),m(o("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>e.customer_name=t),type:"text",class:g(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":r.customer_name||n.apiErrors.customer_name}]),maxlength:"100"},null,2),[[c,e.customer_name]]),r.customer_name?(i(),l("p",{key:0,class:"mt-1 text-sm text-red-600"},u(r.customer_name),1)):n.apiErrors.customer_name?(i(),l("p",{key:1,class:"mt-1 text-sm text-red-600"},u(n.apiErrors.customer_name),1)):p("",!0)]),o("div",null,[o("label",{class:"block text-sm font-medium mb-1"},[T("Tổng tiền "),o("span",{class:"text-red-500"},"*")]),m(o("input",{"onUpdate:modelValue":a[1]||(a[1]=t=>e.total_amount=t),type:"number",class:g(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":r.total_amount||n.apiErrors.total_amount}])},null,2),[[c,e.total_amount]]),r.total_amount?(i(),l("p",{key:0,class:"mt-1 text-sm text-red-600"},u(r.total_amount),1)):n.apiErrors.total_amount?(i(),l("p",{key:1,class:"mt-1 text-sm text-red-600"},u(n.apiErrors.total_amount),1)):p("",!0)]),o("div",null,[o("label",{class:"block text-sm font-medium mb-1"},"Trạng thái"),m(o("select",{"onUpdate:modelValue":a[2]||(a[2]=t=>e.status=t),class:g(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":r.status||n.apiErrors.status}])},[(i(!0),l(z,null,A(f.value,(t,d)=>(i(),l("option",{key:d,value:d},u(t),9,["value"]))),128))],2),[[G,e.status]]),r.status?(i(),l("p",{key:0,class:"mt-1 text-sm text-red-600"},u(r.status),1)):n.apiErrors.status?(i(),l("p",{key:1,class:"mt-1 text-sm text-red-600"},u(n.apiErrors.status),1)):p("",!0)]),o("div",null,[o("label",{class:"block text-sm font-medium mb-1"},"Mô tả"),m(o("textarea",{"onUpdate:modelValue":a[3]||(a[3]=t=>e.description=t),class:g(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":r.description||n.apiErrors.description}]),maxlength:"500"},null,2),[[c,e.description]]),r.description?(i(),l("p",{key:0,class:"mt-1 text-sm text-red-600"},u(r.description),1)):n.apiErrors.description?(i(),l("p",{key:1,class:"mt-1 text-sm text-red-600"},u(n.apiErrors.description),1)):p("",!0)]),o("div",null,[o("label",{class:"block text-sm font-medium mb-1"},"Ngày đặt"),m(o("input",{"onUpdate:modelValue":a[4]||(a[4]=t=>e.created_at=t),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[c,e.created_at]])]),o("div",null,[o("label",{class:"block text-sm font-medium mb-1"},"Ngày cập nhật"),m(o("input",{"onUpdate:modelValue":a[5]||(a[5]=t=>e.updated_at=t),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[c,e.updated_at]])]),o("div",{class:"flex justify-end space-x-3 pt-4"},[o("button",{type:"button",onClick:w,class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none"},"Huỷ"),o("button",{type:"submit",class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none",disabled:b.value},u(b.value?"Đang xử lý...":n.mode==="edit"?"Cập nhật":"Thêm mới"),9,["disabled"])])],32)]),_:1},8,["modelValue","title","loading"]))}};export{W as default};
