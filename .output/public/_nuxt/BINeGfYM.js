import{M as U,G as z,I as c,z as A,c as n,a as e,b as h,e as x,t as l,F as C,g as M,ad as F,o as s,H as $,k as L,d as P}from"./CRPNSmKO.js";import V from"./B9eftp_Y.js";import{_ as Q}from"./BN8nsbAe.js";import{_ as q}from"./D2JkzBjR.js";import{e as H}from"./B4pxijLT.js";import{f as B}from"./CNGtvvPC.js";import"./Bz77BRzt.js";import"./D3qKhv56.js";import"./DlAUqK2U.js";const se={__name:"variants",setup(R){const m=U(),D=F(),o=z(()=>D.params.id),y=c([]),w=c(null),r=c(null),g=c(!1),i=c(!1),u=c(!1),p=c(!1);A(async()=>{await Promise.all([N(),d()])});async function N(){try{const a=await m.get(H.products.update(o.value));w.value=a.data}catch{}}async function d(){g.value=!0;try{const a=await m.get(`/api/admin/products/${o.value}/variants`);y.value=a.data.data||[]}catch{}finally{g.value=!1}}function E(){i.value=!0}function v(){i.value=!1}function K(a){r.value=a,u.value=!0}function b(){u.value=!1,r.value=null}function S(a){r.value=a,p.value=!0}function k(){p.value=!1,r.value=null}async function T(){await d(),v()}async function j(){await d(),b()}async function G(){try{await m.delete(`/api/admin/variants/${r.value.id}`),await d(),k()}catch{}}function I(a){return a==="active"?"Đang bán":a==="inactive"?"Ngừng bán":a}return(a,_)=>(s(),n("div",{class:"container mx-auto p-4"},[e("div",{class:"flex justify-between items-center mb-6"},[e("div",null,[e("h1",{class:"text-2xl font-bold"},"Quản lý biến thể sản phẩm"),e("p",{class:"text-gray-600 mt-1"},l(w.value?.name),1)]),e("div",{class:"flex space-x-3"},[e("button",{onClick:_[0]||(_[0]=t=>a.$router.push(`/admin/products/${o.value}/edit`)),class:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none"}," Quay lại sản phẩm "),e("button",{onClick:E,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none"}," Thêm biến thể mới ")])]),e("div",{class:"bg-white shadow-md rounded-lg overflow-hidden"},[e("table",{class:"min-w-full divide-y divide-gray-200"},[e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"ID"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Ảnh"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"SKU"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Barcode"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Giá gốc"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Giá KM"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Số lượng"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Thuộc tính"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Trạng thái"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Thao tác")])]),e("tbody",{class:"bg-white divide-y divide-gray-200"},[(s(!0),n(C,null,M(y.value,t=>(s(),n("tr",{key:t.id},[e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},l(t.id),1),e("td",{class:"px-6 py-4 whitespace-nowrap"},[t.image?(s(),n("img",{key:0,src:t.image,alt:t.sku,class:"h-10 w-10 rounded-lg object-cover"},null,8,["src","alt"])):(s(),n("div",{key:1,class:"h-10 w-10 rounded-lg bg-gray-200 flex items-center justify-center"},[e("span",{class:"text-gray-400 text-xs"},"No img")]))]),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},l(t.sku),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},l(t.barcode||"N/A"),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},l($(B)(t.price)),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},[t.sale_price?(s(),n("span",{key:0,class:"text-red-600 font-medium"},l($(B)(t.sale_price)),1)):(s(),n("span",{key:1,class:"text-gray-400"},"-"))]),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},l(t.quantity),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},[t.attribute_values&&t.attribute_values.length>0?(s(),n("div",{key:0},[(s(!0),n(C,null,M(t.attribute_values,f=>(s(),n("span",{key:f.id,class:"inline-block bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded mr-1 mb-1"},l(f.attribute?.name)+": "+l(f.value),1))),128))])):(s(),n("span",{key:1,class:"text-gray-400"},"Không có"))]),e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:L(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",t.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},l(I(t.status)),3)]),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},[P(q,{item:t,onEdit:K,onDelete:S},null,8,["item"])])]))),128)),y.value.length===0?(s(),n("tr",{key:0},[e("td",{colspan:"10",class:"px-6 py-4 text-center text-gray-500"},l(g.value?"Đang tải dữ liệu...":"Không có biến thể nào"),1)])):x("",!0)])])]),i.value?(s(),h(V,{key:0,show:i.value,"product-id":o.value,"on-close":v,onCreated:T},null,8,["show","product-id"])):x("",!0),u.value?(s(),h(V,{key:1,show:u.value,variant:r.value,"product-id":o.value,"on-close":b,onUpdated:j},null,8,["show","variant","product-id"])):x("",!0),p.value?(s(),h(Q,{key:2,show:p.value,title:"Xác nhận xóa",message:`Bạn có chắc chắn muốn xóa biến thể ${r.value?.sku||""}?`,"on-close":k,onConfirm:G},null,8,["show","message"])):x("",!0)]))}};export{se as default};
