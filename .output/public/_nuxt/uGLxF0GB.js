import{M as oe,I as v,G as P,O as Q,z as te,c as o,o as u,f as R,e as k,K as W,a as e,k as se,F as j,g as q,t as S,j as Z,b as Ce,i as ne,d as x,H as ue,P as E}from"./CRPNSmKO.js";import{g as Ue}from"./Bz77BRzt.js";import{M as $e}from"./D3qKhv56.js";import{_ as Ae}from"./D_8RvcO3.js";import{_ as w}from"./Dlbv5MmI.js";import{d as re}from"./CONOwAJH.js";import{_ as ie}from"./DlAUqK2U.js";import{e as Y}from"./B4pxijLT.js";import{a as ee}from"./CaxYi4Fr.js";import{_ as Se}from"./BTrW77Yx.js";const Te={__name:"CoreSelectSearchableSelect",props:{modelValue:{type:[String,Number],default:""},placeholder:{type:String,default:"Tìm kiếm..."},searchApi:{type:String,required:!0},disabled:{type:Boolean,default:!1},error:{type:String,default:""},minSearchLength:{type:Number,default:2}},emits:["update:modelValue","change"],setup(C,{emit:H}){const g=C,O=H,L=oe(),b=v(""),N=v(!1),i=v([]),f=v(!1),p=v(null),A=P({get:()=>p.value?p.value.label:b.value,set:m=>{b.value=m}}),D=P(()=>b.value?i.value.filter(m=>m.label.toLowerCase().includes(b.value.toLowerCase())):i.value.slice(0,10)),z=async()=>{if(i.value.length===0){f.value=!0;try{const V=(await L.get(`${g.searchApi}?limit=50`)).data.data||[];V.length<=50?i.value=V:i.value=V.slice(0,50)}catch{}finally{f.value=!1}}},G=re(async()=>{if(b.value.length<g.minSearchLength){i.value=[];return}f.value=!0;try{const m=await L.get(`${g.searchApi}?search=${encodeURIComponent(b.value)}`);i.value=m.data.data||[]}catch{i.value=[]}finally{f.value=!1}},300),I=()=>{b.value.length>=g.minSearchLength?G():i.value=[]},T=async()=>{N.value=!0,await z()},U=()=>{setTimeout(()=>{N.value=!1},200)},F=m=>{p.value=m,b.value="",N.value=!1,O("update:modelValue",m.value),O("change",m.value)};return Q(()=>g.modelValue,async m=>{if(m&&!p.value){const V=i.value.find(d=>d.value===m);if(V)p.value=V;else try{const d=await L.get(`${g.searchApi}?id=${m}`);d.data.data&&d.data.data.length>0&&(p.value=d.data.data[0])}catch{}}else m||(p.value=null)},{immediate:!0}),te(async()=>{if(g.modelValue)try{const m=await L.get(`${g.searchApi}?id=${g.modelValue}`);m.data.data&&m.data.data.length>0&&(p.value=m.data.data[0],i.value=[m.data.data[0]])}catch{}}),(m,V)=>(u(),o("div",{class:"searchable-select relative"},[R(e("input",{"onUpdate:modelValue":V[0]||(V[0]=d=>A.value=d),onInput:I,onFocus:T,onBlur:U,placeholder:C.placeholder,disabled:C.disabled,class:se(["w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",C.error?"border-red-500":"border-gray-300",C.disabled?"bg-gray-100 cursor-not-allowed":"bg-white"])},null,42,["placeholder","disabled"]),[[W,A.value]]),f.value?(u(),o("div",{key:0,class:"absolute right-3 top-1/2 transform -translate-y-1/2"},[e("div",{class:"animate-spin h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full"})])):k("",!0),N.value&&(D.value.length>0||b.value.length>0)?(u(),o("div",{key:1,class:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto"},[(u(!0),o(j,null,q(D.value,d=>(u(),o("div",{key:d.value,onClick:h=>F(d),class:"px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0"},S(d.label),9,["onClick"]))),128)),b.value.length>0&&D.value.length===0&&!f.value?(u(),o("div",{key:0,class:"px-3 py-2 text-gray-500"}," Không tìm thấy kết quả ")):k("",!0),!b.value&&i.value.length>50?(u(),o("div",{key:1,class:"px-3 py-2 text-sm text-gray-500 bg-gray-50 border-t"}," Hiển thị 50 items đầu tiên. Vui lòng tìm kiếm để xem thêm. ")):k("",!0)])):k("",!0)]))}},Me=ie(Te,[["__scopeId","data-v-72888946"]]),Be={__name:"CoreSelectSearchableMultiSelect",props:{modelValue:{type:Array,default:()=>[]},placeholder:{type:String,default:"Tìm kiếm..."},searchApi:{type:String,required:!0},disabled:{type:Boolean,default:!1},error:{type:String,default:""},minSearchLength:{type:Number,default:2}},emits:["update:modelValue","change"],setup(C,{emit:H}){const g=C,O=H,L=oe(),b=v(""),N=v(!1),i=v([]),f=v(!1),p=v([]),A=v(!1),D=P(()=>b.value?i.value.filter(d=>!V(d)&&d.label.toLowerCase().includes(b.value.toLowerCase())):i.value.slice(0,10).filter(d=>!V(d))),z=async()=>{if(i.value.length===0){f.value=!0;try{const h=(await L.get(`${g.searchApi}?limit=50`)).data.data||[];i.value=h}catch{}finally{f.value=!1}}},G=re(async()=>{if(b.value.length<g.minSearchLength){i.value=[];return}f.value=!0;try{const d=await L.get(`${g.searchApi}?search=${encodeURIComponent(b.value)}`);i.value=d.data.data||[]}catch{i.value=[]}finally{f.value=!1}},300),I=()=>{b.value.length>=g.minSearchLength?G():i.value=[]},T=async()=>{N.value=!0,await z()},U=()=>{setTimeout(()=>{N.value=!1},200)},F=d=>{V(d)||(p.value.push(d),O("update:modelValue",p.value.map(h=>h.value)),O("change",p.value.map(h=>h.value))),b.value=""},m=d=>{p.value=p.value.filter(h=>h.value!==d.value),O("update:modelValue",p.value.map(h=>h.value)),O("change",p.value.map(h=>h.value))},V=d=>p.value.some(h=>h.value===d.value);return Q(()=>g.modelValue,async d=>{if(d&&d.length>0){const h=[],y=[];for(const M of d){const K=i.value.find(X=>X.value===M);K?h.push(K):y.push(M)}if(y.length>0)try{const M=await L.get(`${g.searchApi}?ids=${y.join(",")}`);M.data.data&&h.push(...M.data.data)}catch{}p.value=h,A.value=!1}else p.value=[],A.value=!1},{immediate:!0}),te(async()=>{if(g.modelValue&&g.modelValue.length>0)try{const d=await L.get(`${g.searchApi}?ids=${g.modelValue.join(",")}`);d.data.data&&(p.value=d.data.data,i.value=d.data.data)}catch{}}),(d,h)=>(u(),o("div",{class:"searchable-multi-select relative"},[e("div",{class:"selected-items mb-3"},[p.value.length>0?(u(),o("div",{key:0},[p.value.length>3&&!A.value?(u(),o("div",{key:0,class:"flex items-center gap-2"},[e("div",{class:"flex items-center gap-1"},[(u(!0),o(j,null,q(p.value.slice(0,2),(y,M)=>(u(),o("span",{key:y.value,class:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm bg-blue-50 border border-blue-200 text-blue-700"},[e("span",{class:"mr-2"},S(y.label),1),e("button",{onClick:K=>m(y),class:"text-blue-500 hover:text-blue-700 focus:outline-none transition-colors",type:"button"},[(u(),o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})]))],8,["onClick"])]))),128))]),e("button",{onClick:h[0]||(h[0]=y=>A.value=!0),class:"text-blue-600 hover:text-blue-800 text-sm font-medium focus:outline-none transition-colors",type:"button"}," +"+S(p.value.length-2)+" more ",1)])):(u(),o("div",{key:1,class:"flex flex-wrap gap-2"},[(u(!0),o(j,null,q(p.value,y=>(u(),o("span",{key:y.value,class:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm bg-blue-50 border border-blue-200 text-blue-700 hover:bg-blue-100 transition-colors"},[e("span",{class:"mr-2"},S(y.label),1),e("button",{onClick:M=>m(y),class:"text-blue-500 hover:text-blue-700 focus:outline-none transition-colors",type:"button"},[(u(),o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})]))],8,["onClick"])]))),128)),p.value.length>3&&A.value?(u(),o("button",{key:0,onClick:h[1]||(h[1]=y=>A.value=!1),class:"text-blue-600 hover:text-blue-800 text-sm font-medium focus:outline-none transition-colors",type:"button"}," Show less ")):k("",!0)]))])):(u(),o("div",{key:1,class:"text-sm text-gray-500 italic"}," Chưa có danh mục nào được chọn "))]),e("div",{class:"relative"},[R(e("input",{"onUpdate:modelValue":h[2]||(h[2]=y=>b.value=y),onInput:I,onFocus:T,onBlur:U,placeholder:C.placeholder,disabled:C.disabled,class:se(["w-full pl-10 pr-3 py-2.5 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",C.error?"border-red-500":"border-gray-300",C.disabled?"bg-gray-100 cursor-not-allowed":"bg-white"])},null,42,["placeholder","disabled"]),[[W,b.value]]),e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[(u(),o("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})]))])]),f.value?(u(),o("div",{key:0,class:"absolute right-3 top-1/2 transform -translate-y-1/2"},[e("div",{class:"animate-spin h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full"})])):k("",!0),N.value&&(D.value.length>0||b.value.length>0)?(u(),o("div",{key:1,class:"absolute z-50 w-full mt-2 bg-white border border-gray-200 rounded-lg shadow-xl max-h-60 overflow-y-auto"},[(u(!0),o(j,null,q(D.value,y=>(u(),o("div",{key:y.value,onClick:M=>F(y),class:"px-4 py-3 hover:bg-blue-50 cursor-pointer border-b border-gray-100 last:border-b-0 flex items-center justify-between transition-colors"},[e("span",{class:"text-gray-700"},S(y.label),1),V(y)?(u(),o("span",{key:0,class:"text-blue-600"},[(u(),o("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})]))])):k("",!0)],8,["onClick"]))),128)),b.value.length>0&&D.value.length===0&&!f.value?(u(),o("div",{key:0,class:"px-4 py-3 text-gray-500 text-center"},[(u(),o("svg",{class:"w-6 h-6 mx-auto mb-2 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.34 0-4.47-.881-6.08-2.33"})])),Z(" Không tìm thấy kết quả ")])):k("",!0),!b.value&&i.value.length>50?(u(),o("div",{key:1,class:"px-4 py-3 text-sm text-gray-500 bg-gray-50 border-t border-gray-100"},[e("div",{class:"flex items-center"},[(u(),o("svg",{class:"w-4 h-4 mr-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])),Z(" Hiển thị 50 items đầu tiên. Vui lòng tìm kiếm để xem thêm. ")])])):k("",!0)])):k("",!0)]))}},je=ie(Be,[["__scopeId","data-v-7194d39d"]]),Pe={__name:"form",props:{show:Boolean,product:Object,apiErrors:{type:Object,default:()=>({})},mode:String,loading:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(C,{emit:H}){const g=C,O=H,L=v(null),b=P({get:()=>g.show,set:()=>le()}),N=P(()=>g.mode==="edit"?"Chỉnh sửa sản phẩm":"Thêm sản phẩm mới"),i=v([]),f=v([]),p=v(!1),A=v(0),D=v(0),z=v([]),G=v([]),I=v([]),T=v([]),U=v([]),F=v([]),m=P(()=>{const t=g.product||{};let n=t.status||"";return{name:t.name||"",code:t.code||"",short_description:t.short_description||"",description:t.description||"",price:t.price||"",sale_price:t.sale_price||"",brand_id:t.brand_id||"",categories:t.categories||[],weight:t.weight||"",length:t.length||"",width:t.width||"",height:t.height||"",image:t.image||"",status:n,attributes:t.attributes||{}}}),V=P(()=>({name:[{required:"Tên sản phẩm là bắt buộc."},{max:[255,"Tên sản phẩm không được vượt quá 255 ký tự."]}],code:[{max:[50,"Mã sản phẩm không được vượt quá 50 ký tự."]},{pattern:[/^[A-Z0-9\-_]+$/,"Mã sản phẩm chỉ được chứa chữ hoa, số, dấu gạch ngang và gạch dưới."]}],short_description:[{required:"Mô tả ngắn là bắt buộc."},{max:[500,"Mô tả ngắn không được vượt quá 500 ký tự."]}],description:[{required:"Mô tả chi tiết là bắt buộc."}],price:[{required:"Giá gốc là bắt buộc."},{min:[0,"Giá gốc phải lớn hơn hoặc bằng 0."]}],sale_price:[{min:[0,"Giá khuyến mãi phải lớn hơn hoặc bằng 0."]}]}));te(()=>{d(),h()});function d(){const t=Ue("product_status");z.value=t.map(n=>({value:n.value,label:n.label}))}async function h(){try{const n=(await ee.get(`${Y.attributes.list}?relations=values`)).data.data||[];G.value=n,T.value=n}catch{G.value=[],T.value=[]}}function y(t){const n=G.value.find(a=>a.id==t);return n?n.name:""}function M(t){const n=G.value.find(a=>a.id==t);return n?n.attribute_values||[]:[]}function K(t){const n=T.value.find(a=>a.id==t);return n?n.name:""}function X(t){const n=T.value.find(a=>a.id==t);return n?n.attribute_values||[]:[]}function de(){U.value.push({attribute_id:"",value:"",value_id:null})}function ce(t){U.value.splice(t,1)}function pe(t){U.value[t].value="",U.value[t].value_id=null}function me(t){const n=U.value[t];if(n.value_id){const a=X(n.attribute_id).find(s=>s.id==n.value_id);a&&(n.value=a.value)}}function he(t){i.value[t].attribute_items||(i.value[t].attribute_items=[]),i.value[t].attribute_items.push({attribute_id:"",value_id:"",value:""})}function ge(t,n){i.value[t].attribute_items.splice(n,1)}function be(t,n){const a=i.value[t].attribute_items[n];a.value_id="",a.value=""}Q(I,t=>{i.value.forEach(n=>{const a={};t.forEach(s=>{n.attribute_values[s]&&(a[s]=n.attribute_values[s])}),n.attribute_values=a})}),Q(()=>g.product,t=>{if(t){if(t.variants){i.value=t.variants.map(a=>({sku:a.sku||"",barcode:a.barcode||"",price:a.price||"",sale_price:a.sale_price||"",quantity:a.quantity||0,image:a.image||"",status:a.status||"active",attribute_values:a.attribute_values?a.attribute_values.reduce((s,c)=>(s[c.attribute_id]=c.id,s),{}):{},attribute_items:a.attribute_values?a.attribute_values.map(s=>({attribute_id:s.attribute_id,value_id:s.id,value:""})):[]}));const n=new Set;t.variants.forEach(a=>{a.attribute_values&&a.attribute_values.forEach(s=>{n.add(s.attribute_id)})}),I.value=Array.from(n)}t.categories&&Array.isArray(t.categories)?F.value=t.categories.map(n=>n.id||n):F.value=[],t.product_images&&(f.value=t.product_images.map(n=>({url:n.url||"",uploading:!1}))),t.attributes&&(Array.isArray(t.attributes)?t.attributes.forEach(n=>{U.value.push({attribute_id:n.attribute_id,value:n.value,value_id:n.value_id||null})}):typeof t.attributes=="object"&&!Array.isArray(t.attributes)&&Object.keys(t.attributes).forEach(n=>{const a=T.value.find(s=>s.name===n);a&&U.value.push({attribute_id:a.id,value:t.attributes[n],value_id:null})}))}else ve()},{immediate:!0});function ve(){i.value=[],f.value=[],I.value=[],U.value=[],F.value=[]}function fe(){i.value.push({sku:"",barcode:"",price:"",sale_price:"",quantity:0,image:"",status:"active",attribute_values:{},attribute_items:[],uploading:!1})}function ye(t){i.value.splice(t,1)}function xe(t){f.value.splice(t,1)}function ae(t){t.target.style.display="none"}async function ke(t,n){const a=t.target.files[0];if(a){i.value[n].uploading=!0;try{const s=new FormData;s.append("image",a);const c=await ee.post("/api/admin/images/upload",s,{headers:{"Content-Type":"multipart/form-data"}});i.value[n].image=c.data.url||c.data.full_url}catch{alert("Lỗi khi tải ảnh lên")}finally{i.value[n].uploading=!1,t.target.value=""}}}async function we(t){const n=Array.from(t.target.files);if(n.length!==0){p.value=!0,D.value=n.length,A.value=0;try{for(const a of n){const s=new FormData;s.append("image",a);const c=await ee.post("/api/admin/images/upload",s,{headers:{"Content-Type":"multipart/form-data"}});f.value.push({url:c.data.url||c.data.full_url,uploading:!1}),A.value++}}catch{alert("Lỗi khi tải ảnh lên")}finally{p.value=!1,A.value=0,D.value=0,t.target.value=""}}}function Ve(){f.value=[]}function _e(t){const n=[];U.value.forEach(s=>{if(s.value&&s.value.trim()!==""){const c=T.value.find(B=>B.id==s.attribute_id);if(c){const B={attribute_id:s.attribute_id,attribute_name:c.name,value:s.value,type:c.type||"text"};s.value_id&&(B.value_id=s.value_id),n.push(B)}}});const a={...t,attributes:n.length>0?n:null,categories:F.value,variants:i.value.map(s=>{const c={...s};return delete c.uploading,(!c.image||c.image.trim()==="")&&delete c.image,c.attribute_items&&c.attribute_items.length>0&&(c.attribute_values={},c.attribute_items.forEach(B=>{B.attribute_id&&(B.value_id||B.value)&&(c.attribute_values[B.attribute_id]=B.value_id||B.value)})),delete c.attribute_items,c}),images:f.value.map(s=>({url:s.url}))};O("submit",a)}function le(){O("cancel")}return(t,n)=>(u(),Ce($e,{modelValue:b.value,"onUpdate:modelValue":n[1]||(n[1]=a=>b.value=a),title:N.value,loading:C.loading,size:"7xl"},{default:ne(()=>[x(Ae,{"default-values":m.value,rules:V.value,"api-errors":C.apiErrors,"submit-text":g.mode==="edit"?"Cập nhật":"Tạo sản phẩm",onSubmit:_e,onCancel:le,ref_key:"formWrapperRef",ref:L},{default:ne(({form:a,errors:s,clearError:c,isSubmitting:B})=>[e("div",{class:"space-y-8"},[e("div",{class:"bg-gray-50 p-6 rounded-lg"},[e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Thông tin cơ bản"),e("div",{class:"grid grid-cols-1 md:grid-cols-2 gap-6"},[e("div",{class:"md:col-span-2"},[x(w,{modelValue:a.name,"onUpdate:modelValue":[l=>a.name=l,l=>c("name")],label:"Tên sản phẩm",name:"name",error:s.name,required:"",autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error"])]),x(w,{modelValue:a.code,"onUpdate:modelValue":[l=>a.code=l,l=>c("code")],label:"Mã sản phẩm",name:"code",error:s.code,placeholder:"PROD-001",autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error"]),x(w,{modelValue:a.status,"onUpdate:modelValue":[l=>a.status=l,l=>c("status")],label:"Trạng thái",name:"status",type:"select",options:z.value,error:s.status},null,8,["modelValue","onUpdate:modelValue","options","error"]),e("div",{class:"md:col-span-2"},[x(w,{modelValue:a.short_description,"onUpdate:modelValue":[l=>a.short_description=l,l=>c("short_description")],label:"Mô tả ngắn",name:"short_description",type:"textarea",error:s.short_description,required:"",autocomplete:"off"},null,8,["modelValue","onUpdate:modelValue","error"])]),e("div",{class:"md:col-span-2"},[x(w,{modelValue:a.description,"onUpdate:modelValue":[l=>a.description=l,l=>c("description")],label:"Mô tả chi tiết",name:"description",type:"textarea",error:s.description,required:"",rows:5},null,8,["modelValue","onUpdate:modelValue","error"])]),x(w,{modelValue:a.price,"onUpdate:modelValue":[l=>a.price=l,l=>c("price")],label:"Giá gốc",name:"price",type:"number",error:s.price,required:"",min:0,step:.01},null,8,["modelValue","onUpdate:modelValue","error"]),x(w,{modelValue:a.sale_price,"onUpdate:modelValue":[l=>a.sale_price=l,l=>c("sale_price")],label:"Giá khuyến mãi",name:"sale_price",type:"number",error:s.sale_price,min:0,step:.01},null,8,["modelValue","onUpdate:modelValue","error"]),e("div",null,[e("label",{class:"block text-sm font-medium mb-1"},[Z(" Thương hiệu "),e("span",{class:"text-red-500"},"*")]),x(Me,{modelValue:a.brand_id,"onUpdate:modelValue":l=>a.brand_id=l,"search-api":ue(Y).brands.search,placeholder:"Tìm thương hiệu...",error:s.brand_id,onChange:l=>c("brand_id")},null,8,["modelValue","onUpdate:modelValue","search-api","error","onChange"]),s.brand_id?(u(),o("div",{key:0,class:"text-red-500 text-sm mt-1"},S(s.brand_id),1)):k("",!0)]),e("div",null,[e("label",{class:"block text-sm font-medium mb-1"},[Z(" Danh mục "),e("span",{class:"text-red-500"},"*")]),x(je,{modelValue:F.value,"onUpdate:modelValue":n[0]||(n[0]=l=>F.value=l),"search-api":ue(Y).categories.search,placeholder:"Tìm danh mục...",error:s.categories,onChange:l=>c("categories")},null,8,["modelValue","search-api","error","onChange"]),s.categories?(u(),o("div",{key:0,class:"text-red-500 text-sm mt-1"},S(s.categories),1)):k("",!0)]),x(w,{modelValue:a.weight,"onUpdate:modelValue":[l=>a.weight=l,l=>c("weight")],label:"Trọng lượng (kg)",name:"weight",type:"number",error:s.weight,min:0,step:.01},null,8,["modelValue","onUpdate:modelValue","error"]),x(w,{modelValue:a.length,"onUpdate:modelValue":[l=>a.length=l,l=>c("length")],label:"Chiều dài (cm)",name:"length",type:"number",error:s.length,min:0,step:.01},null,8,["modelValue","onUpdate:modelValue","error"]),x(w,{modelValue:a.width,"onUpdate:modelValue":[l=>a.width=l,l=>c("width")],label:"Chiều rộng (cm)",name:"width",type:"number",error:s.width,min:0,step:.01},null,8,["modelValue","onUpdate:modelValue","error"]),x(w,{modelValue:a.height,"onUpdate:modelValue":[l=>a.height=l,l=>c("height")],label:"Chiều cao (cm)",name:"height",type:"number",error:s.height,min:0,step:.01},null,8,["modelValue","onUpdate:modelValue","error"])])]),e("div",{class:"bg-gray-50 p-6 rounded-lg"},[e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Ảnh sản phẩm"),e("div",{class:"mb-6"},[e("label",{class:"block text-sm font-medium mb-2"},"Ảnh chính sản phẩm"),x(Se,{modelValue:a.image,"onUpdate:modelValue":[l=>a.image=l,l=>{a.image=l,c("image")}],"default-url":a.image},null,8,["modelValue","onUpdate:modelValue","default-url"])]),e("div",null,[e("label",{class:"block text-sm font-medium mb-2"},"Ảnh phụ sản phẩm"),e("div",{class:"flex items-center space-x-4 mb-4"},[e("div",{class:"flex-1"},[e("input",{type:"file",onChange:we,accept:"image/*",multiple:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",disabled:p.value},null,40,["disabled"]),p.value?(u(),o("p",{key:0,class:"mt-1 text-sm text-blue-600"}," Đang tải ảnh lên... ("+S(A.value)+"/"+S(D.value)+") ",1)):k("",!0)]),e("button",{onClick:Ve,type:"button",class:"px-3 py-2 text-sm text-red-600 hover:text-red-800"}," Xóa tất cả ")]),f.value.length>0?(u(),o("div",{key:0,class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"},[(u(!0),o(j,null,q(f.value,(l,_)=>(u(),o("div",{key:_,class:"relative group"},[e("img",{src:l.url,alt:`Ảnh phụ ${_+1}`,class:"w-full h-24 object-cover rounded border",onError:ae},null,40,["src","alt"]),e("button",{onClick:r=>xe(_),class:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity"}," × ",8,["onClick"])]))),128))])):k("",!0)])]),e("div",{class:"bg-gray-50 p-6 rounded-lg"},[e("div",{class:"mb-6"},[e("div",{class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},[e("div",{class:"flex items-center justify-between px-4 py-3 bg-gray-50 border-b border-gray-200"},[e("h3",{class:"text-sm font-medium text-gray-700"},"Thuộc tính sản phẩm"),e("button",{onClick:de,type:"button",class:"px-3 py-1 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none text-sm"}," + Thêm thuộc tính ")]),e("table",{class:"min-w-full divide-y divide-gray-200"},[e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Thuộc tính "),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Giá trị "),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20"}," Thao tác ")])]),e("tbody",{class:"bg-white divide-y divide-gray-200"},[(u(!0),o(j,null,q(U.value,(l,_)=>(u(),o("tr",{key:_,class:"hover:bg-gray-50"},[e("td",{class:"px-4 py-3"},[R(e("select",{"onUpdate:modelValue":r=>l.attribute_id=r,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm",onChange:r=>pe(_)},[e("option",{value:""},"-- Chọn thuộc tính --"),(u(!0),o(j,null,q(T.value,r=>(u(),o("option",{key:r.id,value:r.id},S(r.name),9,["value"]))),128))],40,["onUpdate:modelValue","onChange"]),[[E,l.attribute_id]])]),e("td",{class:"px-4 py-3"},[X(l.attribute_id).length>0?R((u(),o("select",{key:0,"onUpdate:modelValue":r=>l.value_id=r,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm",onChange:r=>me(_)},[e("option",{value:""},"-- Chọn giá trị --"),(u(!0),o(j,null,q(X(l.attribute_id),r=>(u(),o("option",{key:r.id,value:r.id},S(r.value),9,["value"]))),128))],40,["onUpdate:modelValue","onChange"])),[[E,l.value_id]]):R((u(),o("input",{key:1,"onUpdate:modelValue":r=>l.value=r,type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm",placeholder:`Nhập ${K(l.attribute_id).toLowerCase()}`},null,8,["onUpdate:modelValue","placeholder"])),[[W,l.value]])]),e("td",{class:"px-4 py-3"},[e("button",{onClick:r=>ce(_),type:"button",class:"text-red-600 hover:text-red-800 text-sm font-medium",title:"Xóa thuộc tính"},[(u(),o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})]))],8,["onClick"])])]))),128)),U.value.length===0?(u(),o("tr",{key:0},[e("td",{colspan:"3",class:"px-4 py-8 text-center text-gray-500"},[e("p",null,"Chưa có thuộc tính nào."),e("p",{class:"text-sm mt-1"},'Click "Thêm thuộc tính" để bắt đầu.')])])):k("",!0)])])]),T.value.length===0?(u(),o("div",{key:0,class:"text-center py-4 text-gray-500 text-sm bg-gray-50 rounded-lg mt-4"},[e("p",{class:"mb-2"},"Chưa có thuộc tính nào để chọn."),e("p",{class:"text-xs"},'Vui lòng tạo thuộc tính trong menu "Thuộc tính" trước.')])):k("",!0)])]),e("div",{class:"bg-gray-50 p-6 rounded-lg"},[e("div",{class:"flex items-center justify-between mb-4"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Biến thể sản phẩm"),e("button",{onClick:fe,type:"button",class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none text-sm"}," + Thêm biến thể ")]),i.value.length>0?(u(),o("div",{key:0,class:"space-y-4"},[(u(!0),o(j,null,q(i.value,(l,_)=>(u(),o("div",{key:_,class:"border rounded-lg p-4 bg-white"},[e("div",{class:"flex items-center justify-between mb-4"},[e("h4",{class:"text-sm font-medium text-gray-900"},"Biến thể "+S(_+1),1),e("button",{onClick:r=>ye(_),type:"button",class:"text-red-600 hover:text-red-800 text-sm"}," Xóa ",8,["onClick"])]),e("div",{class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},[x(w,{modelValue:l.sku,"onUpdate:modelValue":r=>l.sku=r,label:"SKU",name:"sku",type:"text",class:"text-sm"},null,8,["modelValue","onUpdate:modelValue"]),x(w,{modelValue:l.barcode,"onUpdate:modelValue":r=>l.barcode=r,label:"Barcode",name:"barcode",type:"text",class:"text-sm"},null,8,["modelValue","onUpdate:modelValue"]),x(w,{modelValue:l.price,"onUpdate:modelValue":r=>l.price=r,label:"Giá",name:"price",type:"number",step:"0.01",class:"text-sm"},null,8,["modelValue","onUpdate:modelValue"]),x(w,{modelValue:l.sale_price,"onUpdate:modelValue":r=>l.sale_price=r,label:"Giá khuyến mãi",name:"sale_price",type:"number",step:"0.01",class:"text-sm"},null,8,["modelValue","onUpdate:modelValue"]),x(w,{modelValue:l.quantity,"onUpdate:modelValue":r=>l.quantity=r,label:"Số lượng",name:"quantity",type:"number",class:"text-sm"},null,8,["modelValue","onUpdate:modelValue"]),x(w,{modelValue:l.status,"onUpdate:modelValue":r=>l.status=r,label:"Trạng thái",name:"status",type:"select",options:z.value,class:"text-sm"},null,8,["modelValue","onUpdate:modelValue","options"]),e("div",null,[e("label",{class:"block text-sm font-medium mb-1"},"Ảnh biến thể"),e("div",{class:"flex items-center space-x-2"},[e("input",{type:"file",onChange:r=>ke(r,_),accept:"image/*",class:"flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm",disabled:l.uploading},null,40,["onChange","disabled"]),l.image?(u(),o("img",{key:0,src:l.image,alt:"Ảnh biến thể",class:"w-12 h-12 object-cover rounded border",onError:ae},null,40,["src"])):k("",!0)])])]),e("div",{class:"mt-4"},[e("div",{class:"flex items-center justify-between mb-3"},[e("h5",{class:"text-sm font-medium text-gray-700"},"Thuộc tính biến thể:"),e("button",{onClick:r=>he(_),type:"button",class:"px-2 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700 focus:outline-none"}," + Thêm thuộc tính ",8,["onClick"])]),e("div",{class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},[e("table",{class:"min-w-full divide-y divide-gray-200"},[e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Thuộc tính "),e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Giá trị "),e("th",{class:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16"}," Thao tác ")])]),e("tbody",{class:"bg-white divide-y divide-gray-200"},[(u(!0),o(j,null,q(l.attribute_items,(r,J)=>(u(),o("tr",{key:J,class:"hover:bg-gray-50"},[e("td",{class:"px-3 py-2"},[R(e("select",{"onUpdate:modelValue":$=>r.attribute_id=$,class:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",onChange:$=>be(_,J)},[e("option",{value:""},"-- Chọn thuộc tính --"),(u(!0),o(j,null,q(G.value,$=>(u(),o("option",{key:$.id,value:$.id},S($.name),9,["value"]))),128))],40,["onUpdate:modelValue","onChange"]),[[E,r.attribute_id]])]),e("td",{class:"px-3 py-2"},[M(r.attribute_id).length>0?R((u(),o("select",{key:0,"onUpdate:modelValue":$=>r.value_id=$,class:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"},[e("option",{value:""},"-- Chọn giá trị --"),(u(!0),o(j,null,q(M(r.attribute_id),$=>(u(),o("option",{key:$.id,value:$.id},S($.value),9,["value"]))),128))],8,["onUpdate:modelValue"])),[[E,r.value_id]]):R((u(),o("input",{key:1,"onUpdate:modelValue":$=>r.value=$,type:"text",class:"w-full px-2 py-1 border border-gray-300 rounded text-xs focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:`Nhập ${y(r.attribute_id).toLowerCase()}`},null,8,["onUpdate:modelValue","placeholder"])),[[W,r.value]])]),e("td",{class:"px-3 py-2"},[e("button",{onClick:$=>ge(_,J),type:"button",class:"text-red-600 hover:text-red-800 text-xs",title:"Xóa thuộc tính"},[(u(),o("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})]))],8,["onClick"])])]))),128)),!l.attribute_items||l.attribute_items.length===0?(u(),o("tr",{key:0},[e("td",{colspan:"3",class:"px-3 py-4 text-center text-gray-500 text-xs"},[e("p",null,"Chưa có thuộc tính nào."),e("p",{class:"mt-1"},'Click "Thêm thuộc tính" để bắt đầu.')])])):k("",!0)])])])])]))),128))])):(u(),o("div",{key:1,class:"text-center py-8 text-gray-500"},[e("p",null,"Chưa có biến thể nào. Hãy thêm biến thể để tạo sản phẩm có nhiều phiên bản.")]))])])]),_:1},8,["default-values","rules","api-errors","submit-text"])]),_:1},8,["modelValue","title","loading"]))}};export{Pe as default};
