import A from"./CpCKfUBv.js";import{e as f}from"./B4pxijLT.js";import{g as E}from"./Bz77BRzt.js";import{M as O,I as i,N as B,O as j,c as b,b as x,e as S,a as v,o as m}from"./CRPNSmKO.js";import"./D3qKhv56.js";import"./DlAUqK2U.js";import"./D_8RvcO3.js";import"./Dlbv5MmI.js";const U={__name:"edit",props:{show:Boolean,attributeValue:Object,onClose:Function},emits:["updated"],setup(h,{emit:y}){const l=O(),e=h,V=y,c=i(!1),p=i([]),d=i([]),u=i(null),n=i(!1),s=B({});j(()=>e.show,t=>{c.value=t,t?(Object.keys(s).forEach(a=>delete s[a]),w(),g(),e.attributeValue?.id&&_()):(u.value=null,n.value=!1)},{immediate:!0});async function _(){if(e.attributeValue?.id){n.value=!0;try{const t=await l.get(`/api/admin/attribute-values/${e.attributeValue.id}`);u.value=t.data.data||t.data}catch{u.value=e.attributeValue}finally{n.value=!1}}}async function w(){try{const t=E("basic_status");p.value=Array.isArray(t)?t:[]}catch{p.value=[]}}async function g(){try{const t=await l.get(f.attributes.list,{params:{per_page:100}});d.value=t.data.data||[]}catch{d.value=[]}}async function C(t){try{if(!e.attributeValue)return;Object.keys(s).forEach(r=>delete s[r]);const a={...t,_method:"PUT"};await l.post(f.attributeValues.update(e.attributeValue.id),a),V("updated"),e.onClose()}catch(a){if(a.response?.status===422&&a.response?.data?.errors){const r=a.response.data.errors;for(const o in r)Array.isArray(r[o])?s[o]=r[o][0]:s[o]=r[o]}}}function k(){e.onClose&&e.onClose()}return(t,a)=>(m(),b("div",null,[n.value?(m(),b("div",{key:0,class:"flex justify-center items-center p-8"},[v("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),v("span",{class:"ml-2 text-gray-600"},"Đang tải dữ liệu...")])):c.value?(m(),x(A,{key:1,show:c.value,"attribute-value":u.value,"attribute-options":d.value,"status-enums":p.value,"api-errors":s,onSubmit:C,onCancel:k},null,8,["show","attribute-value","attribute-options","status-enums","api-errors"])):S("",!0)]))}};export{U as default};
