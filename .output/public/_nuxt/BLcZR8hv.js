import{I as o,N as I,G as L,z as P,c as u,a as e,b as M,e as c,F as G,g as O,i as S,o as i,t as r,k as h,w as Q,f as Z,j as f,K as T}from"./CRPNSmKO.js";import{a as C}from"./CaxYi4Fr.js";import{e as V}from"./B4pxijLT.js";import{M as j}from"./D3qKhv56.js";import"./DlAUqK2U.js";const te={__name:"index",setup(R){const p=o(!1),w=o(""),m=o(""),v=o(""),y=o(""),g=o(""),x=o(!1),D=o(""),b=o([]),B=o(!1),k=o(""),s=I({}),F=L(()=>({name:[{required:"Tên zone là bắt buộc."},{max:[100,"Tên zone không được vượt quá 100 ký tự."]}],provinces:[{required:"Danh sách tỉnh là bắt buộc."}],base_fee:[{required:"Base fee là bắt buộc."},{number:"Base fee phải là số."}],delivery_time:[{required:"Thời gian giao hàng là bắt buộc."}]}));function _(){Object.keys(s).forEach(t=>delete s[t])}function U(){_();let t=!0;const n=F.value,a={name:m.value,provinces:v.value,base_fee:y.value,delivery_time:g.value};for(const l in n)for(const d of n[l]){if(d.required&&!a[l]){s[l]=d.required,t=!1;break}if(d.max&&a[l]&&a[l].length>d.max[0]){s[l]=d.max[1],t=!1;break}if(d.number&&a[l]&&isNaN(Number(a[l]))){s[l]=d.number,t=!1;break}}return t}function A(t){return t==="active"||t===1?"Đang hoạt động":t==="inactive"||t===0?"Không hoạt động":t}function E(t){return t==="active"||t===1?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}async function N(){B.value=!0,k.value="";try{const t=await C.get(V.shippingZones.list);b.value=t.data.data}catch{k.value="Không lấy được danh sách zone!"}finally{B.value=!1}}P(N);function K(t){w.value=t.name,m.value=t.name,v.value=Array.isArray(t.provinces)?t.provinces.join(","):t.provinces,y.value=t.base_fee,g.value=t.delivery_time,p.value=!0}function X(t){D.value=t.name,x.value=!0}function q(){p.value=!1,w.value="",_()}async function $(){if(!U())return;const t=b.value.find(a=>a.name===m.value),n={name:m.value,provinces:v.value,base_fee:y.value,delivery_time:g.value,status:"active"};try{t?await C.put(V.shippingZones.update(t.id),n):await C.post(V.shippingZones.create,n),await N(),q()}catch{k.value="Lưu zone thất bại!"}}async function H(){const t=b.value.find(n=>n.name===D.value);if(t)try{await C.delete(V.shippingZones.delete(t.id)),await N(),x.value=!1}catch{k.value="Xóa zone thất bại!"}}return(t,n)=>(i(),u("div",{class:"container mx-auto p-4"},[e("div",{class:"flex justify-between items-center mb-6"},[e("h1",{class:"text-2xl font-bold"},"Quản lý Zone Mapping"),e("button",{onClick:n[0]||(n[0]=a=>p.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none"}," Thêm Zone mới ")]),e("div",{class:"bg-white shadow-md rounded-lg overflow-hidden"},[e("table",{class:"min-w-full divide-y divide-gray-200"},[e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"ID"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tên Zone"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Số tỉnh"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Base Fee"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Delivery Time"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Trạng thái"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Thao tác")])]),e("tbody",{class:"bg-white divide-y divide-gray-200"},[(i(!0),u(G,null,O(b.value,a=>(i(),u("tr",{key:a.id},[e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},r(a.id),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},r(a.name),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},r(Array.isArray(a.provinces)?a.provinces.length:(a.provinces||"").split(",").length),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},r(a.base_fee|t.currency),1),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},r(a.delivery_time),1),e("td",{class:"px-6 py-4 whitespace-nowrap"},[e("span",{class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",E(a.status)])},r(A(a.status)),3)]),e("td",{class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},[e("button",{onClick:l=>K(a),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Sửa ",8,["onClick"]),e("button",{onClick:l=>X(a),class:"text-red-600 hover:text-red-900"}," Xóa ",8,["onClick"])])]))),128)),b.value.length===0?(i(),u("tr",{key:0},[e("td",{colspan:"7",class:"px-6 py-4 text-center text-gray-500"}," Không có dữ liệu ")])):c("",!0)])])]),p.value?(i(),M(j,{key:0,modelValue:p.value,"onUpdate:modelValue":n[5]||(n[5]=a=>p.value=a),title:w.value?"Sửa zone":"Thêm zone mới"},{default:S(()=>[e("form",{onSubmit:Q($,["prevent"]),class:"space-y-4"},[e("div",null,[e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[f("Tên zone "),e("span",{class:"text-red-500"},"*")]),Z(e("input",{"onUpdate:modelValue":n[1]||(n[1]=a=>m.value=a),type:"text",class:h(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":s.name}]),maxlength:"100"},null,2),[[T,m.value]]),s.name?(i(),u("p",{key:0,class:"mt-1 text-sm text-red-600"},r(s.name),1)):c("",!0)]),e("div",null,[e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[f("Provinces (phân cách bằng dấu phẩy) "),e("span",{class:"text-red-500"},"*")]),Z(e("input",{"onUpdate:modelValue":n[2]||(n[2]=a=>v.value=a),type:"text",class:h(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":s.provinces}])},null,2),[[T,v.value]]),s.provinces?(i(),u("p",{key:0,class:"mt-1 text-sm text-red-600"},r(s.provinces),1)):c("",!0)]),e("div",null,[e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[f("Base Fee "),e("span",{class:"text-red-500"},"*")]),Z(e("input",{"onUpdate:modelValue":n[3]||(n[3]=a=>y.value=a),type:"number",class:h(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":s.base_fee}])},null,2),[[T,y.value]]),s.base_fee?(i(),u("p",{key:0,class:"mt-1 text-sm text-red-600"},r(s.base_fee),1)):c("",!0)]),e("div",null,[e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[f("Delivery Time "),e("span",{class:"text-red-500"},"*")]),Z(e("input",{"onUpdate:modelValue":n[4]||(n[4]=a=>g.value=a),type:"text",class:h(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":s.delivery_time}])},null,2),[[T,g.value]]),s.delivery_time?(i(),u("p",{key:0,class:"mt-1 text-sm text-red-600"},r(s.delivery_time),1)):c("",!0)]),e("div",{class:"flex justify-end space-x-3 pt-4"},[e("button",{type:"button",onClick:q,class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none"},"Huỷ"),e("button",{type:"submit",class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none"},r(w.value?"Cập nhật":"Thêm mới"),1)])],32)]),_:1},8,["modelValue","title"])):c("",!0),x.value?(i(),M(j,{key:1,modelValue:x.value,"onUpdate:modelValue":n[7]||(n[7]=a=>x.value=a),title:"Xóa zone"},{default:S(()=>[e("div",{class:"py-4 text-center"},[e("p",null,[f("Bạn muốn xóa zone "),e("b",null,r(D.value),1),f("?")]),e("div",{class:"flex justify-end gap-2 mt-6"},[e("button",{type:"button",class:"px-4 py-2 bg-gray-200 rounded-lg",onClick:n[6]||(n[6]=a=>x.value=!1)},"Hủy"),e("button",{type:"button",class:"px-4 py-2 bg-red-600 text-white rounded-lg",onClick:H},"Xóa")])])]),_:1},8,["modelValue"])):c("",!0)]))}};export{te as default};
