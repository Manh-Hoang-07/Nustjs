import{G as f,N as w,O as T,b as j,i as B,o as l,a as e,w as F,f as m,c as i,e as c,j as y,k as p,F as M,g as U,t as d,P as x,K as G}from"./CRPNSmKO.js";import{M as O}from"./D3qKhv56.js";import"./DlAUqK2U.js";const H={__name:"ProductRuleForm",props:{show:Boolean,productRule:Object,products:{type:Array,default:()=>[]},apiErrors:{type:Object,default:()=>({})},mode:String},emits:["submit","cancel"],setup(s,{emit:E}){const b=s,v=E,g=f({get:()=>b.show,set:()=>k()}),V=f(()=>b.mode==="edit"?"Sửa quy tắc sản phẩm":"Thêm quy tắc sản phẩm mới"),t=w({product_id:"",rule_type:"",value:"",status:"active"}),o=w({});T(()=>b.productRule,u=>{u?(t.product_id=u.product_id||"",t.rule_type=u.rule_type||"",t.value=u.value||"",t.status=u.status||"active"):q()},{immediate:!0});function q(){t.product_id="",t.rule_type="",t.value="",t.status="active",h()}function h(){Object.keys(o).forEach(u=>delete o[u])}const C=f(()=>({product_id:[{required:"Sản phẩm là bắt buộc."}],rule_type:[{required:"Loại quy tắc là bắt buộc."}],value:[{required:"Giá trị là bắt buộc."},{number:"Giá trị phải là số."}]}));function S(){h();let u=!0;const a=C.value;for(const r in a)for(const n of a[r]){if(n.required&&!t[r]){o[r]=n.required,u=!1;break}if(n.number&&t[r]&&isNaN(Number(t[r]))){o[r]=n.number,u=!1;break}}return u}function N(){S()&&v("submit",{...t})}function k(){v("cancel")}return(u,a)=>(l(),j(O,{modelValue:g.value,"onUpdate:modelValue":a[4]||(a[4]=r=>g.value=r),title:V.value},{default:B(()=>[e("form",{onSubmit:F(N,["prevent"]),class:"space-y-4"},[e("div",null,[e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[y("Sản phẩm "),e("span",{class:"text-red-500"},"*")]),m(e("select",{"onUpdate:modelValue":a[0]||(a[0]=r=>t.product_id=r),class:p(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":o.product_id||s.apiErrors.product_id}])},[e("option",{value:""},"Chọn sản phẩm"),(l(!0),i(M,null,U(s.products,r=>(l(),i("option",{key:r.id,value:r.id},d(r.name),9,["value"]))),128))],2),[[x,t.product_id]]),o.product_id?(l(),i("p",{key:0,class:"mt-1 text-sm text-red-600"},d(o.product_id),1)):s.apiErrors.product_id?(l(),i("p",{key:1,class:"mt-1 text-sm text-red-600"},d(s.apiErrors.product_id),1)):c("",!0)]),e("div",null,[e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[y("Loại quy tắc "),e("span",{class:"text-red-500"},"*")]),m(e("select",{"onUpdate:modelValue":a[1]||(a[1]=r=>t.rule_type=r),class:p(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":o.rule_type||s.apiErrors.rule_type}])},[e("option",{value:""},"Chọn loại"),e("option",{value:"min_order"},"Đơn tối thiểu"),e("option",{value:"max_order"},"Đơn tối đa"),e("option",{value:"special"},"Đặc biệt")],2),[[x,t.rule_type]]),o.rule_type?(l(),i("p",{key:0,class:"mt-1 text-sm text-red-600"},d(o.rule_type),1)):s.apiErrors.rule_type?(l(),i("p",{key:1,class:"mt-1 text-sm text-red-600"},d(s.apiErrors.rule_type),1)):c("",!0)]),e("div",null,[e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[y("Giá trị "),e("span",{class:"text-red-500"},"*")]),m(e("input",{"onUpdate:modelValue":a[2]||(a[2]=r=>t.value=r),type:"number",class:p(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":o.value||s.apiErrors.value}])},null,2),[[G,t.value]]),o.value?(l(),i("p",{key:0,class:"mt-1 text-sm text-red-600"},d(o.value),1)):s.apiErrors.value?(l(),i("p",{key:1,class:"mt-1 text-sm text-red-600"},d(s.apiErrors.value),1)):c("",!0)]),e("div",null,[e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Trạng thái"),m(e("select",{"onUpdate:modelValue":a[3]||(a[3]=r=>t.status=r),class:p(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":o.status||s.apiErrors.status}])},[e("option",{value:"active"},"Hoạt động"),e("option",{value:"inactive"},"Không hoạt động")],2),[[x,t.status]]),o.status?(l(),i("p",{key:0,class:"mt-1 text-sm text-red-600"},d(o.status),1)):s.apiErrors.status?(l(),i("p",{key:1,class:"mt-1 text-sm text-red-600"},d(s.apiErrors.status),1)):c("",!0)]),e("div",{class:"flex justify-end space-x-3 pt-4"},[e("button",{type:"button",onClick:k,class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none"},"Huỷ"),e("button",{type:"submit",class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none"},d(s.mode==="edit"?"Cập nhật":"Thêm mới"),1)])],32)]),_:1},8,["modelValue","title"]))}};export{H as default};
