import k from"./BNr_J3lQ.js";import{e as E}from"./B4pxijLT.js";import{g}from"./Bz77BRzt.js";import{M as A,I as u,N as B,O as j,c as p,b as x,e as O,a as f,o as d}from"./DDT-0HTi.js";import"./D_ZLElLM.js";import"./DlAUqK2U.js";import"./BOPsCARg.js";import"./yLpPWoGU.js";import"./DCKoXk_D.js";const U={__name:"edit",props:{show:Boolean,attribute:Object,onClose:Function},emits:["updated"],setup(b,{emit:h}){const m=A(),e=b,v=h,c=u(!1),l=u([]),i=u(null),n=u(!1),s=B({});j(()=>e.show,t=>{c.value=t,t?(Object.keys(s).forEach(a=>delete s[a]),_(),e.attribute?.id&&y()):(i.value=null,n.value=!1)},{immediate:!0});async function y(){if(e.attribute?.id){n.value=!0;try{const t=await m.get(`/api/admin/attributes/${e.attribute.id}`);i.value=t.data.data||t.data}catch{i.value=e.attribute}finally{n.value=!1}}}async function _(){try{const t=g("basic_status");l.value=Array.isArray(t)?t:[]}catch{l.value=[]}}async function w(t){try{if(!e.attribute)return;Object.keys(s).forEach(r=>delete s[r]);const a={...t,_method:"PUT"};await m.post(E.attributes.update(e.attribute.id),a),v("updated"),e.onClose()}catch(a){if(a.response?.status===422&&a.response?.data?.errors){const r=a.response.data.errors;for(const o in r)Array.isArray(r[o])?s[o]=r[o][0]:s[o]=r[o]}}}function C(){e.onClose&&e.onClose()}return(t,a)=>(d(),p("div",null,[n.value?(d(),p("div",{key:0,class:"flex justify-center items-center p-8"},[f("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),f("span",{class:"ml-2 text-gray-600"},"Đang tải dữ liệu...")])):c.value?(d(),x(k,{key:1,show:c.value,attribute:i.value,"status-enums":l.value,"api-errors":s,onSubmit:w,onCancel:C},null,8,["show","attribute","status-enums","api-errors"])):O("",!0)]))}};export{U as default};
