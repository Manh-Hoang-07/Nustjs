import{G as k,N as w,I as U,O as M,b as T,i as O,o as s,a as r,w as B,c as i,e as u,f as p,j as D,k as b,K as x,t as d}from"./DDT-0HTi.js";import{M as N}from"./D_ZLElLM.js";import"./DlAUqK2U.js";const F={__name:"image-form",props:{show:Boolean,image:Object,productId:[String,Number],apiErrors:{type:Object,default:()=>({})},mode:String},emits:["submit","cancel","created","updated"],setup(l,{emit:E}){const m=l,f=E,g=k({get:()=>m.show,set:()=>y()}),v=k(()=>m.mode==="edit"?"Chỉnh sửa ảnh":"Thêm ảnh mới"),t=w({url:"",alt_text:"",caption:"",order:0}),e=w({}),c=U(!1);M(()=>m.image,o=>{o?(t.url=o.url||"",t.alt_text=o.alt_text||"",t.caption=o.caption||"",t.order=o.order||0):V()},{immediate:!0});function V(){t.url="",t.alt_text="",t.caption="",t.order=0,h()}function h(){Object.keys(e).forEach(o=>delete e[o])}function C(){return h(),t.url.trim()?t.url.length>500&&(e.url="URL ảnh không được vượt quá 500 ký tự"):e.url="URL ảnh là bắt buộc",t.alt_text&&t.alt_text.length>255&&(e.alt_text="Mô tả ảnh không được vượt quá 255 ký tự"),t.caption&&t.caption.length>500&&(e.caption="Chú thích không được vượt quá 500 ký tự"),t.order<0&&(e.order="Thứ tự không được âm"),Object.keys(e).length===0}function j(){if(C()){c.value=!0;try{const o=new FormData;Object.entries(t).forEach(([n,a])=>{a!=null&&a!==""&&o.append(n,a)}),o.append("imageable_type","App\\Models\\Product"),o.append("imageable_id",m.productId),f("submit",o)}finally{c.value=!1}}}function S(o){o.target.style.display="none",o.target.nextElementSibling&&(o.target.nextElementSibling.style.display="block")}function y(){f("cancel")}return(o,n)=>(s(),T(N,{modelValue:g.value,"onUpdate:modelValue":n[4]||(n[4]=a=>g.value=a),title:v.value},{default:O(()=>[r("form",{onSubmit:B(j,["prevent"]),class:"space-y-4"},[r("div",null,[r("label",{class:"block text-sm font-medium mb-1"},[D("URL ảnh "),r("span",{class:"text-red-500"},"*")]),p(r("input",{"onUpdate:modelValue":n[0]||(n[0]=a=>t.url=a),type:"text",class:b(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":e.url||l.apiErrors.url}]),maxlength:"500"},null,2),[[x,t.url]]),e.url?(s(),i("p",{key:0,class:"mt-1 text-sm text-red-600"},d(e.url),1)):l.apiErrors.url?(s(),i("p",{key:1,class:"mt-1 text-sm text-red-600"},d(l.apiErrors.url),1)):u("",!0)]),t.url?(s(),i("div",{key:0,class:"border rounded-lg p-4"},[r("label",{class:"block text-sm font-medium mb-2"},"Xem trước:"),r("img",{src:t.url,alt:t.alt_text||"Preview",class:"w-full h-32 object-cover rounded",onError:S},null,40,["src","alt"])])):u("",!0),r("div",null,[r("label",{class:"block text-sm font-medium mb-1"},"Mô tả ảnh (Alt text)"),p(r("input",{"onUpdate:modelValue":n[1]||(n[1]=a=>t.alt_text=a),type:"text",class:b(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":e.alt_text||l.apiErrors.alt_text}]),maxlength:"255"},null,2),[[x,t.alt_text]]),e.alt_text?(s(),i("p",{key:0,class:"mt-1 text-sm text-red-600"},d(e.alt_text),1)):l.apiErrors.alt_text?(s(),i("p",{key:1,class:"mt-1 text-sm text-red-600"},d(l.apiErrors.alt_text),1)):u("",!0)]),r("div",null,[r("label",{class:"block text-sm font-medium mb-1"},"Chú thích"),p(r("textarea",{"onUpdate:modelValue":n[2]||(n[2]=a=>t.caption=a),class:b(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":e.caption||l.apiErrors.caption}]),rows:"3",maxlength:"500"},null,2),[[x,t.caption]]),e.caption?(s(),i("p",{key:0,class:"mt-1 text-sm text-red-600"},d(e.caption),1)):l.apiErrors.caption?(s(),i("p",{key:1,class:"mt-1 text-sm text-red-600"},d(l.apiErrors.caption),1)):u("",!0)]),r("div",null,[r("label",{class:"block text-sm font-medium mb-1"},"Thứ tự hiển thị"),p(r("input",{"onUpdate:modelValue":n[3]||(n[3]=a=>t.order=a),type:"number",class:b(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",{"border-red-500":e.order||l.apiErrors.order}]),min:"0"},null,2),[[x,t.order]]),e.order?(s(),i("p",{key:0,class:"mt-1 text-sm text-red-600"},d(e.order),1)):l.apiErrors.order?(s(),i("p",{key:1,class:"mt-1 text-sm text-red-600"},d(l.apiErrors.order),1)):u("",!0)]),r("div",{class:"flex justify-end space-x-3 pt-4"},[r("button",{type:"button",onClick:y,class:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none"},"Huỷ"),r("button",{type:"submit",class:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none",disabled:c.value},d(c.value?"Đang xử lý...":l.mode==="edit"?"Cập nhật":"Thêm mới"),9,["disabled"])])],32)]),_:1},8,["modelValue","title"]))}};export{F as default};
