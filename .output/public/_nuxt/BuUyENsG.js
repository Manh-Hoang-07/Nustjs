import C from"./BtvY8zYJ.js";import{e as k}from"./B4pxijLT.js";import{M as _,I as c,N as E,O as B,c as m,b as g,e as j,a as p,o as u}from"./CRPNSmKO.js";import"./D3qKhv56.js";import"./DlAUqK2U.js";const D={__name:"edit",props:{show:Boolean,role:Object,statusEnums:{type:Array,default:()=>[]},onClose:Function},emits:["updated"],setup(d,{emit:h}){const f=_(),e=d,v=h,i=c(!1),l=c(null),n=c(!1),a=E({});B(()=>e.show,t=>{i.value=t,t?(Object.keys(a).forEach(s=>delete a[s]),e.role?.id&&y()):(l.value=null,n.value=!1)},{immediate:!0});async function y(){if(e.role?.id){n.value=!0;try{const t=await f.get(`/api/admin/roles/${e.role.id}`);l.value=t.data.data||t.data}catch{l.value=e.role}finally{n.value=!1}}}async function b(t){try{if(!e.role)return;Object.keys(a).forEach(o=>delete a[o]);const s={...t,_method:"PUT"},r=await f.post(k.roles.update(e.role.id),s);v("updated"),e.onClose()}catch(s){if(s.response?.status===422&&s.response?.data?.errors){const r=s.response.data.errors;for(const o in r)Array.isArray(r[o])?a[o]=r[o][0]:a[o]=r[o]}}}function w(){e.onClose&&e.onClose()}return(t,s)=>(u(),m("div",null,[n.value?(u(),m("div",{key:0,class:"flex justify-center items-center p-8"},[p("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),p("span",{class:"ml-2 text-gray-600"},"Đang tải dữ liệu...")])):i.value?(u(),g(C,{key:1,show:i.value,role:l.value,"status-enums":d.statusEnums,"api-errors":a,onSubmit:b,onCancel:w},null,8,["show","role","status-enums","api-errors"])):j("",!0)]))}};export{D as default};
