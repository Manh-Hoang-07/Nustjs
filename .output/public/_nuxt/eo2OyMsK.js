import{M as B,I as T,N as E,G as k,c,o as n,a as s,F as p,g as b}from"./DDT-0HTi.js";import{_ as z}from"./DlAUqK2U.js";function ae(t,m={}){const y=B(),{defaultFilters:l={},defaultSort:I="created_at_desc",cacheEnabled:C=!0,debounceTime:P=300,pageSize:d=10}=m,r=T([]),o=T(!1),u=T(null),h=E({current_page:1,from:0,to:0,total:0,per_page:d,links:[]}),v=E({...l}),w=new Map;let L=null;const F=k(()=>r.value.length>0),N=k(()=>!o.value&&r.value.length===0),O=k(()=>h.current_page===1),D=k(()=>h.current_page===h.last_page),M=e=>JSON.stringify({...v,...e}),A=(e,a,i=300*1e3)=>{w.set(e,{data:a,timestamp:Date.now(),ttl:i})},W=e=>{const a=w.get(e);return a?Date.now()-a.timestamp>a.ttl?(w.delete(e),null):a.data:null},_=(e={})=>{L&&clearTimeout(L),L=setTimeout(()=>{g(e)},P)},g=async(e={})=>{if(o.value){console.warn("API call already in progress, skipping...");return}o.value=!0,u.value=null;try{const a={...v,...e},i=M(a);if(C){const x=W(i);if(x)return r.value=x.data,Object.assign(h,x.meta),o.value=!1,x}const $=await y.get(t,{params:a}),{data:S,meta:j}=$.data;return r.value=S,Object.assign(h,j),C&&A(i,{data:S,meta:j}),{data:S,meta:j}}catch(a){throw u.value=a.userMessage||"Lỗi tải dữ liệu",r.value=[],a}finally{o.value=!1}};return{items:r,loading:o,error:u,pagination:h,filters:v,hasData:F,isEmpty:N,isFirstPage:O,isLastPage:D,fetchData:g,debouncedFetch:_,updateFilters:e=>{Object.keys(e).some(i=>v[i]!==e[i])&&(Object.assign(v,e),g())},resetFilters:()=>{Object.keys(l).some(a=>v[a]!==l[a])&&(Object.assign(v,l),g())},changePage:e=>{g({page:e})},changePageSize:e=>{h.per_page=e,g({page:1,per_page:e})},createItem:async e=>{try{const a=await y.post(t,e);return await g(),a.data}catch(a){throw u.value=a.userMessage||"Lỗi tạo dữ liệu",a}},updateItem:async(e,a)=>{try{const i=await y.put(`${t}/${e}`,a);return await g(),i.data}catch(i){throw u.value=i.userMessage||"Lỗi cập nhật dữ liệu",i}},deleteItem:async e=>{try{await y.delete(`${t}/${e}`),await g()}catch(a){throw u.value=a.userMessage||"Lỗi xóa dữ liệu",a}},clearCache:()=>{w.clear()},refresh:()=>g()}}const f=T([]);let K=0;function se(){const t=(d,r="info",o=3e3)=>{const u=++K,h={id:u,message:d,type:r,duration:o,visible:!0};return f.value.push(h),setTimeout(()=>{m(u)},o),u},m=d=>{const r=f.value.findIndex(o=>o.id===d);r>-1&&(f.value[r].visible=!1,setTimeout(()=>{f.value.splice(r,1)},300))};return{toasts:f,showToast:t,showSuccess:(d,r)=>t(d,"success",r),showError:(d,r)=>t(d,"error",r),showWarning:(d,r)=>t(d,"warning",r),showInfo:(d,r)=>t(d,"info",r),removeToast:m,clearAll:()=>{f.value=[]}}}const q={__name:"CoreLoadingSkeletonLoader",props:{type:{type:String,default:"default",validator:t=>["table","card","form","list","default"].includes(t)},rows:{type:Number,default:5},columns:{type:Number,default:4},fields:{type:Number,default:5},items:{type:Number,default:3}},setup(t){return(m,y)=>(n(),c("div",{class:"animate-pulse"},[t.type==="table"?(n(),c("div",{key:0,class:"bg-white shadow-md rounded-lg overflow-hidden"},[s("div",{class:"px-6 py-3 bg-gray-50 border-b border-gray-200"},[s("div",{class:"flex justify-between items-center"},[s("div",{class:"h-4 bg-gray-200 rounded w-1/4"}),s("div",{class:"h-8 bg-gray-200 rounded w-24"})])]),s("div",{class:"divide-y divide-gray-200"},[(n(!0),c(p,null,b(t.rows,l=>(n(),c("div",{key:l,class:"px-6 py-4"},[s("div",{class:"flex items-center space-x-4"},[(n(!0),c(p,null,b(t.columns,I=>(n(),c("div",{key:I,class:"flex-1"},[s("div",{class:"h-4 bg-gray-200 rounded"})]))),128))])]))),128))])])):t.type==="card"?(n(),c("div",{key:1,class:"bg-white rounded-lg shadow-md p-6"},[s("div",{class:"flex items-center space-x-4 mb-4"},[s("div",{class:"w-12 h-12 bg-gray-200 rounded-full"}),s("div",{class:"flex-1"},[s("div",{class:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),s("div",{class:"h-3 bg-gray-200 rounded w-1/2"})])]),s("div",{class:"space-y-2"},[s("div",{class:"h-3 bg-gray-200 rounded"}),s("div",{class:"h-3 bg-gray-200 rounded w-5/6"}),s("div",{class:"h-3 bg-gray-200 rounded w-4/6"})])])):t.type==="form"?(n(),c("div",{key:2,class:"space-y-6"},[(n(!0),c(p,null,b(t.fields,l=>(n(),c("div",{key:l,class:"space-y-2"},[s("div",{class:"h-4 bg-gray-200 rounded w-1/4"}),s("div",{class:"h-10 bg-gray-200 rounded"})]))),128)),s("div",{class:"flex justify-end space-x-3 pt-4"},[s("div",{class:"h-10 bg-gray-200 rounded w-20"}),s("div",{class:"h-10 bg-gray-200 rounded w-20"})])])):t.type==="list"?(n(),c("div",{key:3,class:"space-y-3"},[(n(!0),c(p,null,b(t.items,l=>(n(),c("div",{key:l,class:"flex items-center space-x-3 p-3 bg-white rounded-lg shadow"},[s("div",{class:"w-10 h-10 bg-gray-200 rounded"}),s("div",{class:"flex-1"},[s("div",{class:"h-4 bg-gray-200 rounded w-3/4 mb-1"}),s("div",{class:"h-3 bg-gray-200 rounded w-1/2"})]),s("div",{class:"w-20 h-8 bg-gray-200 rounded"})]))),128))])):(n(),c("div",{key:4,class:"space-y-3"},[(n(!0),c(p,null,b(t.items,l=>(n(),c("div",{key:l,class:"h-4 bg-gray-200 rounded"}))),128))]))]))}},te=z(q,[["__scopeId","data-v-2b5e9a70"]]);export{te as S,se as a,ae as u};
